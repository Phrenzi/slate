<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #f8f8f2;
  background-color: #272822;
}
.highlight .err {
  color: #151515;
  background-color: #ac4142;
}
.highlight .c, .highlight .cd, .highlight .cm, .highlight .c1, .highlight .cs {
  color: #505050;
}
.highlight .cp {
  color: #f4bf75;
}
.highlight .nt {
  color: #f4bf75;
}
.highlight .o, .highlight .ow {
  color: #d0d0d0;
}
.highlight .p, .highlight .pi {
  color: #d0d0d0;
}
.highlight .gi {
  color: #90a959;
}
.highlight .gd {
  color: #ac4142;
}
.highlight .gh {
  color: #6a9fb5;
  background-color: #151515;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #aa759f;
}
.highlight .kc {
  color: #d28445;
}
.highlight .kt {
  color: #d28445;
}
.highlight .kd {
  color: #d28445;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #90a959;
}
.highlight .sr {
  color: #75b5aa;
}
.highlight .si {
  color: #8f5536;
}
.highlight .se {
  color: #8f5536;
}
.highlight .nn {
  color: #f4bf75;
}
.highlight .nc {
  color: #f4bf75;
}
.highlight .no {
  color: #f4bf75;
}
.highlight .na {
  color: #6a9fb5;
}
.highlight .m, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mb, .highlight .mx {
  color: #90a959;
}
.highlight .ss {
  color: #90a959;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='#'>Sign Up for a Developer Key</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="introduction">Introduction</h1>

<p>Welcome to the Phrenzi API! You can use our API to access Phrenzi API endpoints, which can get
information on various establishments, transactions, and challenges in our database.</p>

<p>We have language bindings in Shell! You can view code examples in the dark area to the right, and you can switch the programming language of the examples with the tabs in the top right.</p>

<h1 id="api-standard">API standard</h1>

<p>for apis in Phrenzi, we follow <a href="http://jsonapi.org">JSON API</a>. Clients built around JSON API are able to take advantage of its features around efficiently caching responses, sometimes eliminating network requests entirely.</p>

<h1 id="authentication">Authentication</h1>

<blockquote>
<p>To authorize, use this code:</p>
</blockquote>
<pre class="highlight shell"><code><span class="c"># With shell, you can just pass the correct header with each request</span>
curl <span class="s2">"api_endpoint_here"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="c"># this tell server to response with json \</span>
  -H <span class="s2">"access-token: token"</span> <span class="se">\</span>
  -H <span class="s2">"token-type: Bearer"</span> <span class="se">\</span>
  -H <span class="s2">"client: u4N6u_toFnoDR1o318uOVA"</span> <span class="se">\</span>
  -H <span class="s2">"expiry: 1466692376"</span> <span class="se">\</span>
  -H <span class="s2">"uid: abc@example.com"</span>
</code></pre>

<blockquote>
<p>auth header here is required, and can be retrieved from header in last api response.</p>
</blockquote>

<p>We take security as a first priority, so following security mechanism is under consider during design API:</p>

<ul>
<li>token is change after every request</li>
<li>all the token we using during exchanged is hashed using BCrypt ( not plain text stored )</li>
<li>we use securely compared ( to protect against timing attacks )</li>
<li>token is invalidate after 2 weeks</li>
</ul>

<h2 id="auth-header">Auth Header</h2>

<p>after authenticate ( for example, sign in api call), the header from api response will have
following 5 tags, we call it <code class="prettyprint">Auth Header</code>, client need to extract out <code class="prettyprint">Auth Header</code>,
and insert it in header of next api call. For a exmaple of Auth Header, please have a look at right hand side.</p>

<p>Noted: Any client can easily extract out this <code class="prettyprint">Auth Header</code> exchange logic into a library and shared it out.</p>

<ul>
<li>access-token</li>
<li>token-type</li>
<li>client</li>
<li>expiry</li>
<li>uid</li>
</ul>

          <h1 id="json-objects">Json Objects</h1>

<p>normally, a api response in Phrenzi, will be somehow like this in the right hand side :</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ABCCDD"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"patrons"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Simon"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"abc@example.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"credit-balance"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123.22"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trans-code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"asdfw1"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>In <code class="prettyprint">data</code> tag, it represent the important part for client to consuming, either a json object, or
Array of json objects. It would be easier for us to classify different json object from Phrenzi api
returned, so we list all the different json object here:</p>

<p>For example, the api response on the right hand side represent a <code class="prettyprint">Patron</code> json object below.</p>

<h2 id="patron">Patron</h2>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>String</td>
<td>&lsquo;Simon Iong&rsquo;</td>
<td>the name of Patron</td>
</tr>
<tr>
<td>credit-balance</td>
<td>String</td>
<td>&#39;123.22&rsquo;</td>
<td>the current avaliable balance for Patron</td>
</tr>
<tr>
<td>email</td>
<td>String</td>
<td>&ldquo;abc@example.com&rdquo;</td>
<td>the email from Patron</td>
</tr>
<tr>
<td>trans-code</td>
<td>String</td>
<td>&ldquo;asdfw1&rdquo;</td>
<td>6 digit trans code</td>
</tr>
</tbody></table>

<h2 id="basic-patron">Basic Patron</h2>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>String</td>
<td>&#39;Simon Iong&rsquo;</td>
<td>the name of Patron</td>
</tr>
<tr>
<td>credit_balance</td>
<td>String</td>
<td>&ldquo;123.22&rdquo;</td>
<td>the current avaliable balance for Patron</td>
</tr>
<tr>
<td>trans-code</td>
<td>String</td>
<td>&ldquo;asdfw1&rdquo;</td>
<td>6 digit trans code</td>
</tr>
</tbody></table>

<h2 id="manager">Manager</h2>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>String</td>
<td>&#39;Simon Iong&rsquo;</td>
<td>the name of Manager</td>
</tr>
<tr>
<td>email</td>
<td>String</td>
<td>&#39;abc@example.com&rsquo;</td>
<td>the email from Manager</td>
</tr>
</tbody></table>

<h2 id="establishment">Establishment</h2>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>String</td>
<td>&#39;Awesome Bar&rsquo;</td>
<td>the name of Establishment</td>
</tr>
<tr>
<td>phone</td>
<td>String</td>
<td>&#39;123434123&rsquo;</td>
<td>the phone contact for Establishment</td>
</tr>
<tr>
<td>desc</td>
<td>String</td>
<td>&#39;asdfsad&rsquo;</td>
<td>the desc for Establishment</td>
</tr>
<tr>
<td>cash_back</td>
<td>String</td>
<td>&#39;3.5&rsquo;</td>
<td>the current cash back setting</td>
</tr>
<tr>
<td>address</td>
<td>Address object</td>
<td>see below</td>
<td>the address object attached to this establishment</td>
</tr>
<tr>
<td>business_hours</td>
<td>Array of Business Hour</td>
<td>see below</td>
<td>totally 7 business hour object</td>
</tr>
</tbody></table>

<h2 id="basic-establishment">Basic Establishment</h2>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>String</td>
<td>&#39;Awesome Bar&rsquo;</td>
<td>the name of Establishment</td>
</tr>
<tr>
<td>phone</td>
<td>String</td>
<td>&#39;123434123&rsquo;</td>
<td>the phone contact for Establishment</td>
</tr>
<tr>
<td>desc</td>
<td>String</td>
<td>&#39;asdfsad&rsquo;</td>
<td>the desc for Establishment</td>
</tr>
<tr>
<td>cash_back</td>
<td>String</td>
<td>&#39;3.5&rsquo;</td>
<td>the current cash back setting</td>
</tr>
</tbody></table>

<h2 id="address">Address</h2>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>street1</td>
<td>String</td>
<td>&#39;Ma Wan MainRold&rsquo;</td>
<td>the street1 for Establishment</td>
</tr>
<tr>
<td>street2</td>
<td>String</td>
<td>&#39;Ma Wan&rsquo;</td>
<td>the street2 for Establishment</td>
</tr>
<tr>
<td>city</td>
<td>String</td>
<td>&#39;Hong Kong&rsquo;</td>
<td>city for Establishment</td>
</tr>
<tr>
<td>country</td>
<td>String</td>
<td>&#39;HK&rsquo;</td>
<td>country name for ISO 3166-1 standard</td>
</tr>
</tbody></table>

<h2 id="business-hour">Business Hour</h2>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>open_time</td>
<td>Integer</td>
<td>43200</td>
<td>the integer represent the seconds start from mid night, range from 0..86400</td>
</tr>
<tr>
<td>close_time</td>
<td>Integer</td>
<td>63200</td>
<td>the integer represent the seconds start from mid night, range from 0..129600, means, until 12pm next day</td>
</tr>
<tr>
<td>wday</td>
<td>Integer</td>
<td>1</td>
<td>integer represent the day in the week, 0 for sunday, 1 for monday, etc</td>
</tr>
<tr>
<td>closed</td>
<td>Boolean</td>
<td>false</td>
<td>true/false, true stands for establishment is close this day</td>
</tr>
</tbody></table>

<h2 id="transaction">Transaction</h2>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>patron_id</td>
<td>String</td>
<td>&#39;ADSSDD&rsquo;</td>
<td>the unique code for Patron this transaction is belongs to</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td>&#39;sale&rsquo;</td>
<td>type of transaction, either &#39;sale&rsquo;, or &#39;correction&rsquo;</td>
</tr>
<tr>
<td>sale_amount</td>
<td>String</td>
<td>&#39;200.00&rsquo;</td>
<td>different meaning for different scenarios</td>
</tr>
<tr>
<td>credit_amount</td>
<td>String</td>
<td>&#39;7.00&rsquo;</td>
<td>different meaning for different scenarios</td>
</tr>
<tr>
<td>tracked_at</td>
<td>Datetime</td>
<td>&ldquo;2016-06-04T07:48:56.050Z&rdquo;</td>
<td>ISO_8601 format datetime string</td>
</tr>
</tbody></table>

<h3 id="scenario-1-fully-sale-record">Scenario 1: fully sale record:</h3>

<p>sale amount is 200, cash_back setting is 3.5%, then earned credit 7.00</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>patron_id</td>
<td>String</td>
<td>&#39;ADSSDD&rsquo;</td>
<td>the unique code for Patron this transaction is belongs to</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td>&#39;sale&rsquo;</td>
<td>type of transaction, either &#39;sale&rsquo;, or &#39;credit&rsquo;, or &#39;correction&rsquo;</td>
</tr>
<tr>
<td>sale_amount</td>
<td>String</td>
<td>&#39;200.00&rsquo;</td>
<td>the sale amount of this transaction</td>
</tr>
<tr>
<td>credit_amount</td>
<td>String</td>
<td>&#39;7.00&rsquo;</td>
<td>the credit patron get from this transaction</td>
</tr>
<tr>
<td>tracked_at</td>
<td>Datetime</td>
<td>&ldquo;2016-06-04T07:48:56.050Z&rdquo;</td>
<td>ISO_8601 format datetime string</td>
</tr>
</tbody></table>

<h3 id="scenario-2-partially-credit-redeem">Scenario 2: Partially credit redeem:</h3>

<p>sale amount is 200, 125 credit redeemed, then sale &amp; credit record would be:</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>patron_id</td>
<td>String</td>
<td>&#39;ADSSDD&rsquo;</td>
<td>the unique code for Patron this transaction is belongs to</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td>&#39;sale&rsquo;</td>
<td>type of transaction</td>
</tr>
<tr>
<td>sale_amount</td>
<td>String</td>
<td>&#39;75.00&rsquo;</td>
<td>in this case, we deduct 125 credit</td>
</tr>
<tr>
<td>credit_amount</td>
<td>String</td>
<td>&#39;2.63&rsquo;</td>
<td>75 * 0.035 = 2.625</td>
</tr>
<tr>
<td>tracked_at</td>
<td>Datetime</td>
<td>&ldquo;2016-06-04T07:48:56.050Z&rdquo;</td>
<td>ISO_8601 format datetime string</td>
</tr>
</tbody></table>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>patron_id</td>
<td>String</td>
<td>&#39;ADSSDD&rsquo;</td>
<td>the unique code for Patron this transaction is belongs to</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td>&#39;credit&rsquo;</td>
<td>type of transaction</td>
</tr>
<tr>
<td>sale_amount</td>
<td>String</td>
<td>&#39;125.00&rsquo;</td>
<td>the sale amount redeem by credit</td>
</tr>
<tr>
<td>credit_amount</td>
<td>String</td>
<td>&rsquo;-125.00&rsquo;</td>
<td>the credit deduct from current balance of Patron</td>
</tr>
<tr>
<td>tracked_at</td>
<td>Datetime</td>
<td>&ldquo;2016-06-04T07:48:56.050Z&rdquo;</td>
<td>ISO_8601 format datetime string</td>
</tr>
</tbody></table>

<h3 id="scenario-3-fully-credit-redeem">Scenario 3: Fully credit redeem:</h3>

<p>sale amount is 200, 200 credit redeemed, then there is no sale record, only credit record.</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>patron_id</td>
<td>String</td>
<td>&#39;ADSSDD&rsquo;</td>
<td>the unique code for Patron this transaction is belongs to</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td>&#39;credit&rsquo;</td>
<td>type of transaction</td>
</tr>
<tr>
<td>sale_amount</td>
<td>String</td>
<td>&#39;200.00&rsquo;</td>
<td>the sale amount redeem by credit</td>
</tr>
<tr>
<td>credit_amount</td>
<td>String</td>
<td>&rsquo;-200.00&rsquo;</td>
<td>the credit deduct from current balance of Patron</td>
</tr>
<tr>
<td>tracked_at</td>
<td>Datetime</td>
<td>&ldquo;2016-06-04T07:48:56.050Z&rdquo;</td>
<td>ISO_8601 format datetime string</td>
</tr>
</tbody></table>

<h3 id="scenario-3-credit-correct">Scenario 3: Credit correct:</h3>

<p>manager decide to deduct 200 credit balance for Patron.</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>patron_id</td>
<td>String</td>
<td>&#39;ADSSDD&rsquo;</td>
<td>the unique code for Patron this transaction is belongs to</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td>&#39;correction&rsquo;</td>
<td>type of transaction</td>
</tr>
<tr>
<td>sale_amount</td>
<td>String</td>
<td>&#39;0.00&rsquo;</td>
<td>the sale amount redeem by credit</td>
</tr>
<tr>
<td>credit_amount</td>
<td>String</td>
<td>&rsquo;-200.00&rsquo;</td>
<td>deduct 200 from system</td>
</tr>
<tr>
<td>tracked_at</td>
<td>Datetime</td>
<td>&ldquo;2016-06-04T07:48:56.050Z&rdquo;</td>
<td>ISO_8601 format datetime string</td>
</tr>
</tbody></table>

          <h1 id="patrons">Patrons</h1>

<h2 id="sign-up">Sign Up</h2>
<pre class="highlight shell"><code>curl <span class="s2">"http://phrenzi.com/api/patrons"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -X POST <span class="se">\</span>
  -d <span class="s1">'{
        "name": "Simon",
        "email": "abc@gmail.com",
        "password": "password",
        "password_confirmation": "password",
        "confirm_success_url": "phrenzi://"
        }'</span>
</code></pre>

<blockquote>
<p>if success, the above command returns HTTP Status Code <code class="prettyprint">200</code> with following json objects:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ABCDDD"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"patrons"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Simon"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"abc@gmail.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"credit-balance"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>if failed, the above command returns HTTP Status Code <code class="prettyprint">422</code> with following json objects:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"already in use"</span><span class="p">],</span><span class="w">
    </span><span class="nt">"full_messages"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Email already in use"</span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint try to register a account for Patron.</p>

<ul>
<li>if success, it will return HTTP Status Code <code class="prettyprint">200</code> with <code class="prettyprint">Patron</code> json object</li>
<li>if failed, it will return HTTP Status Code <code class="prettyprint">422</code>, and with <code class="prettyprint">errors</code> json message</li>
</ul>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST http://phrenzi.com/api/patrons</code></p>

<h3 id="url-parameters">URL Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>the name of patron</td>
</tr>
<tr>
<td>email</td>
<td>the email of patron</td>
</tr>
<tr>
<td>password</td>
<td>the password of patron account</td>
</tr>
<tr>
<td>password_confirmation</td>
<td>confirm password again</td>
</tr>
<tr>
<td>confirm_success_url</td>
<td>the url after confirmation link is click</td>
</tr>
</tbody></table>

<h2 id="sign-in">Sign In</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/patrons/sign_in"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -X POST <span class="se">\</span>
  -d <span class="s1">'{
        "email": "abc@gmail.com",
        "password": "password" }'</span>
</code></pre>

<blockquote>
<p>if success, the above command returns <code class="prettyprint">Patron</code> object with <code class="prettyprint">200</code> status code, and structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ADSFSDA"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Simon Iong"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"abc@example.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"credit-balance"</span><span class="p">:</span><span class="w"> </span><span class="s2">"233.23"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>if failed, the above command returns status code <code class="prettyprint">401</code> and json structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"Invalid login credentials. Please try again."</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>if patron is not confirmed yet, return status code <code class="prettyprint">401</code> and json like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"A confirmation email was sent to your account at 'abc@gmail.com'. You must follow the instructions in the email before your account can be activated"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint try to authenticate Patron</p>

<ul>
<li>if success, it will return <code class="prettyprint">Patron</code> object with HTTP Status Code <code class="prettyprint">200</code>, and client can retrive
auth header from reponse to consuming next request that need authentication.</li>
<li>if failed to authenticate, it will return HTTP Status Code <code class="prettyprint">401</code> with <code class="prettyprint">errors</code> message.</li>
</ul>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST http://example.com/api/patrons/sign_in</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>email</td>
<td>the email of patron account</td>
</tr>
<tr>
<td>password</td>
<td>the password of patron account</td>
</tr>
</tbody></table>

<h2 id="sign-out">Sign Out</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/patrons/sign_out"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"access-token: token"</span> <span class="se">\</span>
  -H <span class="s2">"token-type: Bearer"</span> <span class="se">\</span>
  -H <span class="s2">"client: u4N6u_toFnoDR1o318uOVA"</span> <span class="se">\</span>
  -H <span class="s2">"expiry: 1466692376"</span> <span class="se">\</span>
  -H <span class="s2">"uid: abc@example.com"</span>
  -X DELETE
</code></pre>

<blockquote>
<p>if success, the above command returns status code <code class="prettyprint">200</code>, and json object like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>if failed, the above command returns status code <code class="prettyprint">404</code>, and errors json like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"User was not found or was not logged in."</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>this endpoint need <code class="prettyprint">Auth Header</code> to authenticate patron,
you are going to get it from Patron <code class="prettyprint">Sign In</code> api request
or other subsequence request that need authentication.</p>

<ul>
<li>if success, it will return HTTP Status Code <code class="prettyprint">200</code></li>
<li>if failed to authenticate, it will return HTTP Status Code <code class="prettyprint">404</code> with <code class="prettyprint">errors</code> message.</li>
</ul>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">DELETE http://example.com/api/patrons/sign_out</code></p>

<h2 id="confirmation-patron">Confirmation Patron</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/patrons/confirmation"</span> <span class="se">\</span>
  -X GET
  -d <span class="s1">'{
    "confirmation_token": "abcasdfasd",
    "redirect_url": "phrenzi://",
    "config": "default"
    }'</span>
</code></pre>

<blockquote>
<p>if success, it will redirect to the <code class="prettyprint">redirect_url</code> specify in this api</p>

<p>if failed, it will raise an exception ActionController::RoutingError</p>
</blockquote>

<p>during sign up procedure of patron ( client call Patron sign up API ),
server will sent out a confirmation email to Patron&rsquo;s mailbox,
patron will need to click a link in that email,
there&rsquo;s a generated confirmation_token in there, which will be use to call
in this endpoint.</p>

<aside class="warning">Client don&rsquo;t need to call this API.</aside>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://example.com/api/patrons/confirmation</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>confirmation_token</td>
<td>the confirmation token for patron</td>
</tr>
<tr>
<td>redirect_url</td>
<td>the params is pass-in from patron sign up API</td>
</tr>
<tr>
<td>config</td>
<td>the config object, which is <code class="prettyprint">default</code></td>
</tr>
</tbody></table>

<h2 id="request-reset-password">Request Reset Password</h2>
<pre class="highlight shell"><code>curl <span class="s2">"http://example.com/api/patrons/passwords"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -X POST <span class="se">\</span>
  -d <span class="s1">'{
        "email": "abc@gmail.com" }'</span>
        <span class="s2">"redirect_url"</span>: <span class="s2">"phrenzi://"</span> <span class="o">}</span><span class="s1">'
</span></code></pre>

<blockquote>
<p>if success, return HTTP Status Code <code class="prettyprint">200</code> without following json object</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"An email has been sent to 'abc@gmail.com' containing instructions for resetting your password."</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>if email not found, return HTTP Status Code `404, with following json object</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"Unable to find user with email 'abc@gmail.com.'"</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>if email is missing, return HTTP Status Code <code class="prettyprint">401</code>, with following json object</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"You must provide an email address."</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>if redirect_url is missing, return HTTP Status Code <code class="prettyprint">401</code>, with following json object</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"Missing redirect URL."</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This api is used while Patron forget password, and after this api is invoked and is success, a email
will trigger and sent to Patron&rsquo;s registered email</p>

<ul>
<li>if success, it will return HTTP Status Code <code class="prettyprint">200</code> without json object</li>
<li>if email is missing, it will return HTTP Status Code <code class="prettyprint">401</code></li>
<li>if redirect_url is missing, it will return HTTP Status Code <code class="prettyprint">401</code></li>
<li>if email is not found in server, it will return HTTP Status Code <code class="prettyprint">404</code></li>
</ul>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST http://phrenzi.com/api/patrons/passwords</code></p>

<h3 id="url-parameters">URL Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>email</td>
<td>the email of patron</td>
</tr>
<tr>
<td>redirect_url</td>
<td>the url that is used within reset password email to redirect back to app</td>
</tr>
</tbody></table>

<h2 id="password-reset-link">Password Reset Link</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/patrons/password/edit"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -X GET <span class="se">\</span>
  -d <span class="s1">'{
    "reset_password_token": "abcasdfasd",
    "redirect_url": "phrenzi://"
    }'</span>
</code></pre>

<blockquote>
<p>if success, it will redirect to the <code class="prettyprint">redirect_url</code> specify in this api</p>

<p>if failed, it will raise an exception ActionController::RoutingError</p>
</blockquote>

<p>during password reset procedure of patron ( client call Patron request password reset API ), server
will sent out a password reset email to Patron&rsquo;s mailbox,
patron will need to click a link in that email,
which will trigger this call if Patron click that link.
If every thing is fine, Patron will redirect to app,
with <code class="prettyprint">auth header</code> in a request, then App can
retrieve <code class="prettyprint">auth header</code> from that redirect request.</p>

<aside class="warning">Client don&rsquo;t need to call this API.</aside>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://phrenzi.com/api/patrons/password/edit</code></p>

<h3 id="url-parameters">URL Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>reset_password_token</td>
<td>reset password token</td>
</tr>
<tr>
<td>redirect_url</td>
<td>a link to redirect back after success operation</td>
</tr>
</tbody></table>

<h2 id="update-password">Update Password</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/patrons/password"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"access-token: token"</span> <span class="se">\</span>
  -H <span class="s2">"token-type: Bearer"</span> <span class="se">\</span>
  -H <span class="s2">"client: u4N6u_toFnoDR1o318uOVA"</span> <span class="se">\</span>
  -H <span class="s2">"expiry: 1466692376"</span> <span class="se">\</span>
  -H <span class="s2">"uid: abc@example.com"</span> <span class="se">\</span>
  -X PATCH <span class="se">\</span>
  -d <span class="s1">'{
    "password": "new_password",
    "password_confirmation": "new_password"
    }'</span>
</code></pre>

<blockquote>
<p>if success, it will response with http status code <code class="prettyprint">200</code>, and with following json object</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Your password has been successfully updated."</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>if failed, for example, password mismatch, response with http status code <code class="prettyprint">422</code>,
and with following json object</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"password_confirmation"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"doesn't match Password"</span><span class="p">],</span><span class="w">
    </span><span class="nt">"full_messages"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Password confirmation doesn't match Password"</span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>if not authenticate, response with <code class="prettyprint">401</code> and following json object,</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Unauthorized"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This api endpoint need Patron authenticated.</p>

<ul>
<li>if success, response with http status code <code class="prettyprint">200</code></li>
<li>if authenticate failed, response with http status code <code class="prettyprint">401</code></li>
<li>if validation failed, for example, passsord mismatch, response with http status code <code class="prettyprint">422</code></li>
</ul>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">PATCH http://phrenzi.com/api/patrons/password</code></p>

<h3 id="url-parameters">URL Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>password</td>
<td>the new password of patron</td>
</tr>
<tr>
<td>password_confirmation</td>
<td>confirm again the new password</td>
</tr>
</tbody></table>

          <h1 id="managers">Managers</h1>

<h2 id="sign-in">Sign In</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/managers/sign_in"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -X POST <span class="se">\</span>
  -d <span class="s1">'{
        "email": "abc@gmail.com",
        "password": "password" }'</span>
</code></pre>

<blockquote>
<p>if success, the above command returns <code class="prettyprint">Manager</code> object with <code class="prettyprint">200</code> status code, and structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ADSFSDA"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Simon Iong"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"abc@example.com"</span><span class="p">,</span><span class="w">
    </span><span class="err">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>if failed, the above command returns status code <code class="prettyprint">401</code> and json structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"Invalid login credentials. Please try again."</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>if manager is not confirmed yet, return status code <code class="prettyprint">401</code> and json like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"A confirmation email was sent to your account at 'abc@gmail.com'. You must follow the instructions in the email before your account can be activated"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint try to authenticate Manager</p>

<ul>
<li>if success, it will return <code class="prettyprint">Manager</code> object with HTTP Status Code <code class="prettyprint">200</code>, and client can retrive
auth header from reponse to consuming next request that need authentication.</li>
<li>if failed to authenticate, it will return HTTP Status Code <code class="prettyprint">401</code> with <code class="prettyprint">errors</code> message.</li>
</ul>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST http://example.com/api/managers/sign_in</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>email</td>
<td>the email of manager account</td>
</tr>
<tr>
<td>password</td>
<td>the password of manager account</td>
</tr>
</tbody></table>

<h2 id="sign-out">Sign Out</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/managers/sign_out"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"access-token: token"</span> <span class="se">\</span>
  -H <span class="s2">"token-type: Bearer"</span> <span class="se">\</span>
  -H <span class="s2">"client: u4N6u_toFnoDR1o318uOVA"</span> <span class="se">\</span>
  -H <span class="s2">"expiry: 1466692376"</span> <span class="se">\</span>
  -H <span class="s2">"uid: abc@example.com"</span>
  -X DELETE
</code></pre>

<blockquote>
<p>if success, the above command returns status code <code class="prettyprint">200</code>, and json object like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>if failed, the above command returns status code <code class="prettyprint">404</code>, and errors json like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"User was not found or was not logged in."</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>this endpoint need <code class="prettyprint">Auth Header</code> to authenticate manager,
you are going to get it from Manager <code class="prettyprint">Sign In</code> api request
or other subsequence request that need authentication.</p>

<ul>
<li>if success, it will return HTTP Status Code <code class="prettyprint">200</code></li>
<li>if failed to authenticate, it will return HTTP Status Code <code class="prettyprint">404</code> with <code class="prettyprint">errors</code> message.</li>
</ul>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">DELETE http://example.com/api/managers/sign_out</code></p>

          <h1 id="establishments">Establishments</h1>

<h2 id="get-all-establishments">get all establishments</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/establishments"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: app_token"</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"WE7EASD"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Awesome Bar"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"phone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"92342333"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"desc"</span><span class="p">:</span><span class="w"> </span><span class="s2">"this is a sample description"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"cash_back"</span><span class="p">:</span><span class="w"> </span><span class="mf">3.5</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"street1"</span><span class="p">:</span><span class="w"> </span><span class="s2">"street 1 example"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"street2"</span><span class="p">:</span><span class="w"> </span><span class="s2">"street 2 example"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"city"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hong Kong"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hong Kong"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"business_hours"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w"> 
        </span><span class="nt">"wday"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nt">"open_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234123123</span><span class="p">,</span><span class="w">
        </span><span class="nt">"close_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">1244444433</span><span class="p">,</span><span class="w">
        </span><span class="nt">"closed"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w"> 
        </span><span class="nt">"wday"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"open_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234123123</span><span class="p">,</span><span class="w">
        </span><span class="nt">"close_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">1244444433</span><span class="p">,</span><span class="w">
        </span><span class="nt">"closed"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w"> 
        </span><span class="nt">"wday"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="nt">"open_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234123123</span><span class="p">,</span><span class="w">
        </span><span class="nt">"close_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">1244444433</span><span class="p">,</span><span class="w">
        </span><span class="nt">"closed"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w"> 
        </span><span class="nt">"wday"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
        </span><span class="nt">"open_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234123123</span><span class="p">,</span><span class="w">
        </span><span class="nt">"close_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">1244444433</span><span class="p">,</span><span class="w">
        </span><span class="nt">"closed"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w"> 
        </span><span class="nt">"wday"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
        </span><span class="nt">"open_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234123123</span><span class="p">,</span><span class="w">
        </span><span class="nt">"close_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">1244444433</span><span class="p">,</span><span class="w">
        </span><span class="nt">"closed"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w"> 
        </span><span class="nt">"wday"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
        </span><span class="nt">"open_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234123123</span><span class="p">,</span><span class="w">
        </span><span class="nt">"close_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">1244444433</span><span class="p">,</span><span class="w">
        </span><span class="nt">"closed"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w"> 
        </span><span class="nt">"wday"</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w">
        </span><span class="nt">"open_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234123123</span><span class="p">,</span><span class="w">
        </span><span class="nt">"close_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">1244444433</span><span class="p">,</span><span class="w">
        </span><span class="nt">"closed"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
      </span><span class="p">}]</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"WE7EASD"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Awesome Bar 2"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"phone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"92342333"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"desc"</span><span class="p">:</span><span class="w"> </span><span class="s2">"this is a sample description"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"cash_back"</span><span class="p">:</span><span class="w"> </span><span class="mf">3.5</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"street1"</span><span class="p">:</span><span class="w"> </span><span class="s2">"street 1 example"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"street2"</span><span class="p">:</span><span class="w"> </span><span class="s2">"street 2 example"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"city"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hong Kong"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Hong Kong"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"business_hours"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w"> 
        </span><span class="nt">"wday"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nt">"open_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234123123</span><span class="p">,</span><span class="w">
        </span><span class="nt">"close_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">1244444433</span><span class="p">,</span><span class="w">
        </span><span class="nt">"closed"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w"> 
        </span><span class="nt">"wday"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"open_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234123123</span><span class="p">,</span><span class="w">
        </span><span class="nt">"close_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">1244444433</span><span class="p">,</span><span class="w">
        </span><span class="nt">"closed"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w"> 
        </span><span class="nt">"wday"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="nt">"open_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234123123</span><span class="p">,</span><span class="w">
        </span><span class="nt">"close_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">1244444433</span><span class="p">,</span><span class="w">
        </span><span class="nt">"closed"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w"> 
        </span><span class="nt">"wday"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
        </span><span class="nt">"open_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234123123</span><span class="p">,</span><span class="w">
        </span><span class="nt">"close_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">1244444433</span><span class="p">,</span><span class="w">
        </span><span class="nt">"closed"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w"> 
        </span><span class="nt">"wday"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
        </span><span class="nt">"open_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234123123</span><span class="p">,</span><span class="w">
        </span><span class="nt">"close_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">1244444433</span><span class="p">,</span><span class="w">
        </span><span class="nt">"closed"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w"> 
        </span><span class="nt">"wday"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
        </span><span class="nt">"open_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234123123</span><span class="p">,</span><span class="w">
        </span><span class="nt">"close_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">1244444433</span><span class="p">,</span><span class="w">
        </span><span class="nt">"closed"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w"> 
        </span><span class="nt">"wday"</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w">
        </span><span class="nt">"open_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">1234123123</span><span class="p">,</span><span class="w">
        </span><span class="nt">"close_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">1244444433</span><span class="p">,</span><span class="w">
        </span><span class="nt">"closed"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
      </span><span class="p">}]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>

<p>This endpoint authenticate by <code class="prettyprint">app_token</code>, and retrieves all establishments</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://example.com/api/establishments</code></p>

<aside class="warning">We will add pagination parameter later, but for this phase, we just skip it.</aside>

          <h1 id="patron-transactions">Patron / Transactions</h1>

<h2 id="get-all-transactions-for-patron">get all transactions for patron</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/patrons/transactions"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: user_token"</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"WE7EASD"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"patron_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ASDFQWE"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sale"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"sale_amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">75.00</span><span class="p">,</span><span class="w">
    </span><span class="nt">"credit_amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">2.63</span><span class="p">,</span><span class="w">
    </span><span class="nt">"tracked_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-06-04T07:48:56.050Z"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"WE7EASS"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"patron_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ASDFQWE"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"credit"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"sale_amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">125.00</span><span class="p">,</span><span class="w">
    </span><span class="nt">"credit_amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">-125.00</span><span class="p">,</span><span class="w">
    </span><span class="nt">"tracked_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-06-04T07:48:56.050Z"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"WE7EASE"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"patron_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ASDFQWE"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"correct"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"sale_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"credit_amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">2.00</span><span class="p">,</span><span class="w">
    </span><span class="nt">"tracked_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-06-04T07:48:56.050Z"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"WE7ESSE"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"patron_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ASDFQWE"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"correct"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"sale_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"credit_amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">-20.00</span><span class="p">,</span><span class="w">
    </span><span class="nt">"tracked_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-06-04T07:48:56.050Z"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>

<p>This endpoint authenticate by <code class="prettyprint">user_token</code>, and retrieves all transaction for specific user</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://example.com/api/patrons/establishments</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>page</td>
<td>the page results of all transactions</td>
</tr>
<tr>
<td>per_page</td>
<td>the number of transaction record return per page by api, default to be 20</td>
</tr>
</tbody></table>

          <h1 id="management-patrons">Management / Patrons</h1>

<h2 id="get-all-patrons">Get all patrons</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/management/patrons"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: manager_token"</span>
</code></pre>

<blockquote>
<p>The above command returns array of <code class="prettyprint">Basic Patron</code> object like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ASDSDS"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Simon Iong"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"credit_balance"</span><span class="p">:</span><span class="w"> </span><span class="mf">123.32</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ASDDD"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Max Max"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"credit_balance"</span><span class="p">:</span><span class="w"> </span><span class="mf">124.44</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>

<p>This endpoint require <code class="prettyprint">manager_token</code>, and retrieves all patrons.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://phrenzi.com/api/management/patrons</code></p>

          <h1 id="management-transactions">Management / Transactions</h1>

<h2 id="get-all-transactions-by-establishment">Get all transactions by establishment</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/management/transactions"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: manager_token"</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"WE7EASD"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"patron_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ASDFQWE"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sale"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"sale_amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">75.00</span><span class="p">,</span><span class="w">
    </span><span class="nt">"credit_amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">2.63</span><span class="p">,</span><span class="w">
    </span><span class="nt">"tracked_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-06-04T07:48:56.050Z"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"WE7EASS"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"patron_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ASSSFQWE"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"credit"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"sale_amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">125.00</span><span class="p">,</span><span class="w">
    </span><span class="nt">"credit_amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">-125.00</span><span class="p">,</span><span class="w">
    </span><span class="nt">"tracked_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-06-04T07:48:56.050Z"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"WE7EASE"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"patron_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ASDFQWE"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"correct"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"sale_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"credit_amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">2.00</span><span class="p">,</span><span class="w">
    </span><span class="nt">"tracked_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-06-04T07:48:56.050Z"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"WE7ESSE"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"patron_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ASSSFQWE"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"correct"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"sale_amount"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nt">"credit_amount"</span><span class="p">:</span><span class="w"> </span><span class="mf">-20.00</span><span class="p">,</span><span class="w">
    </span><span class="nt">"tracked_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-06-04T07:48:56.050Z"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>

<p>This endpoint authenticate by <code class="prettyprint">manager_token</code>, and retrieves transaction records by establishment with different conditions.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://example.com/api/management/transactions</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Requred?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>patron_id</td>
<td>N</td>
<td>if this patron_id is present, the result should only return transactions related to this</td>
</tr>
</tbody></table>

<p>patron
page | N | the page results of all transactions
per_page | N | the number of transaction record return per page by api, default to be 20</p>

<h2 id="create-transaction">Create Transaction</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/management/transactions"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: manager_token"</span> <span class="se">\</span>
  -X POST <span class="se">\</span>
  -d <span class="s1">'{
    "type": "sale",
    "sale_amount": 200.00
    }'</span>
</code></pre>

<blockquote>
<p>The above command returns HTML status code 200 OK if success.</p>
</blockquote>

<p>This endpoint required <code class="prettyprint">manager_token</code>, and create transaction records.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST http://example.com/api/management/transactions</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>Y</td>
<td>sale/correction</td>
</tr>
<tr>
<td>sale_amount</td>
<td>Y</td>
<td>the sale amount</td>
</tr>
<tr>
<td>credit_amount</td>
<td>N</td>
<td>the credit amount</td>
</tr>
</tbody></table>

<h3 id="query-exmaple">Query Exmaple:</h3>

<p>normal sale record, without credit redeem:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>&lsquo;sale&rsquo;</td>
</tr>
<tr>
<td>sale_amount</td>
<td>200.00</td>
</tr>
</tbody></table>

<p>sale record, without partially credit redeem ( 200 sale amount, but with 125 credit redeem , so patron just need to pay 75.00 ):</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>&#39;sale&rsquo;</td>
</tr>
<tr>
<td>sale_amount</td>
<td>200.00</td>
</tr>
<tr>
<td>credit_amount</td>
<td>-125.00</td>
</tr>
</tbody></table>

<p>sale record, fully credit redeem ( 200 sale amount, 200 credit redeem, so patron do not need to pay):</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>&#39;sale&rsquo;</td>
</tr>
<tr>
<td>sale_amount</td>
<td>200.00</td>
</tr>
<tr>
<td>credit_amount</td>
<td>-200.00</td>
</tr>
</tbody></table>

<p>positive correction record:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>&#39;correction&rsquo;</td>
</tr>
<tr>
<td>sale_amount</td>
<td>0.00</td>
</tr>
<tr>
<td>credit_amount</td>
<td>125.00</td>
</tr>
</tbody></table>

<p>negative correction record:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>&#39;correction&rsquo;</td>
</tr>
<tr>
<td>sale_amount</td>
<td>0.00</td>
</tr>
<tr>
<td>credit_amount</td>
<td>-125.00</td>
</tr>
</tbody></table>

          <h1 id="management-settings">Management / Settings</h1>

<h2 id="get-cash-back">Get cash back</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/management/settings/cash_back"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: manager_token"</span>
</code></pre>

<blockquote>
<p>The above command returns <code class="prettyprint">Basic Establishment</code> object like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"WE7EASD"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Awesome Bar"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"phone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"92342333"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"desc"</span><span class="p">:</span><span class="w"> </span><span class="s2">"this is a sample description"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"cash_back"</span><span class="p">:</span><span class="w"> </span><span class="mf">3.5</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint require <code class="prettyprint">manager_token</code>, and return whole establishment object</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://phrenzi.com/api/management/cash_back</code></p>

<h2 id="update-cash-back">Update cash back</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/management/settings/cash_back"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: manager_token"</span> <span class="se">\</span>
  -X PATCH <span class="se">\</span>
  -d <span class="s1">'{
    "current_password": "current_password",
    "cash_back": 4.5
    }'</span>
</code></pre>

<blockquote>
<p>The above command returns HTML status code 200 OK</p>
</blockquote>

<p>This endpoint require <code class="prettyprint">manager_token</code>, and update cash_back for current establishment.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">PATCH http://phrenzi.com/api/management/cash_back</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>cash_back</td>
<td>the cash_back to update, within 0 and 100</td>
</tr>
<tr>
<td>current_password</td>
<td>the current password for current manager</td>
</tr>
</tbody></table>

<h2 id="update-password">Update Password</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/management/settings/passwords"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: manager_token"</span> <span class="se">\</span>
  -X PATCH <span class="se">\</span>
  -d <span class="s1">'{
    "current_password": "current_password",
    "password": "new_password",
    "password_confirmation": "new_password"
    }'</span>
</code></pre>

<blockquote>
<p>The above command returns HTML status code 200 OK</p>
</blockquote>

<p>This endpoint require <code class="prettyprint">manager_token</code>, and update current password for current manager.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">PATCH http://phrenzi.com/api/management/settings/update_password</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>current_password</td>
<td>the current password for current manager</td>
</tr>
<tr>
<td>password</td>
<td>the new password for current manager</td>
</tr>
<tr>
<td>password_confirmation</td>
<td>confirmation for the new password</td>
</tr>
</tbody></table>

          <h1 id="errors">Errors</h1>

<p>The Phrenzi API uses the following error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request &ndash; Your request sucks</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized &ndash; Your API key is wrong</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden &ndash; The resource requested is hidden for administrators only</td>
</tr>
<tr>
<td>404</td>
<td>Not Found &ndash; The specified resource could not be found</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed &ndash; You tried to access a resource with an invalid method</td>
</tr>
<tr>
<td>406</td>
<td>Not Acceptable &ndash; You requested a format that isn&rsquo;t json</td>
</tr>
<tr>
<td>410</td>
<td>Gone &ndash; The resource requested has been removed from our servers</td>
</tr>
<tr>
<td>422</td>
<td>Unprocessable Entity, this happend while request params have validation errors</td>
</tr>
<tr>
<td>429</td>
<td>Too Many Requests &ndash; You&rsquo;re requesting too many resources! Slow down!</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error &ndash; We had a problem with our server. Try again later.</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable &ndash; We&rsquo;re temporarially offline for maintanance. Please try again later.</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
          </div>
      </div>
    </div>
  </body>
</html>
