<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #f8f8f2;
  background-color: #272822;
}
.highlight .err {
  color: #151515;
  background-color: #ac4142;
}
.highlight .c, .highlight .cd, .highlight .cm, .highlight .c1, .highlight .cs {
  color: #505050;
}
.highlight .cp {
  color: #f4bf75;
}
.highlight .nt {
  color: #f4bf75;
}
.highlight .o, .highlight .ow {
  color: #d0d0d0;
}
.highlight .p, .highlight .pi {
  color: #d0d0d0;
}
.highlight .gi {
  color: #90a959;
}
.highlight .gd {
  color: #ac4142;
}
.highlight .gh {
  color: #6a9fb5;
  background-color: #151515;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #aa759f;
}
.highlight .kc {
  color: #d28445;
}
.highlight .kt {
  color: #d28445;
}
.highlight .kd {
  color: #d28445;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #90a959;
}
.highlight .sr {
  color: #75b5aa;
}
.highlight .si {
  color: #8f5536;
}
.highlight .se {
  color: #8f5536;
}
.highlight .nn {
  color: #f4bf75;
}
.highlight .nc {
  color: #f4bf75;
}
.highlight .no {
  color: #f4bf75;
}
.highlight .na {
  color: #6a9fb5;
}
.highlight .m, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mb, .highlight .mx {
  color: #90a959;
}
.highlight .ss {
  color: #90a959;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='#'>Sign Up for a Developer Key</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="introduction">Introduction</h1>

<p>Welcome to the Phrenzi API! You can use our API to access Phrenzi API endpoints, which can get
information on various establishments, transactions, and challenges in our database.</p>

<p>We have language bindings in Shell! You can view code examples in the dark area to the right, and you can switch the programming language of the examples with the tabs in the top right.</p>

<h1 id="api-version">API Version</h1>

<p>We have only 1 version of API now in Phrenzi,
but we are going to increse the API version in the future if we need to.
So it is better to claim the version of API you are going to call,
by inserting a special header item in every of your request.</p>

<aside class="success">If client do not specify the api version, then server will assume that client want to request latest version of API. </aside>

<blockquote>
<p>To specify the version of API, simply insert a header <code class="prettyprint">ACCEPT</code>, with a value with <code class="prettyprint">phrenzi.v#{version_of_api}</code>, example:</p>
</blockquote>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api_endpoint"</span> <span class="se">\</span>
  -H <span class="s2">"ACCEPT: phrenzi.v1"</span> <span class="se">\</span>
</code></pre>

<h1 id="authentication">Authentication</h1>

<blockquote>
<p>To authorize, use this code:</p>
</blockquote>
<pre class="highlight shell"><code><span class="c"># With shell, you can just pass the correct header with each request</span>
curl <span class="s2">"api_endpoint_here"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="c"># this tell server to response with json \</span>
  -H <span class="s2">"access-token: token"</span> <span class="se">\</span>
  -H <span class="s2">"token-type: Bearer"</span> <span class="se">\</span>
  -H <span class="s2">"client: u4N6u_toFnoDR1o318uOVA"</span> <span class="se">\</span>
  -H <span class="s2">"expiry: 1466692376"</span> <span class="se">\</span>
  -H <span class="s2">"uid: abc@example.com"</span>
</code></pre>

<blockquote>
<p>auth header here is required, and can be retrieved from header in last api response.</p>
</blockquote>

<p>We take security as a first priority, so following security mechanism is under consider during design API:</p>

<ul>
<li>token is change after every request</li>
<li>all the token we using during exchanged is hashed using BCrypt ( not plain text stored )</li>
<li>we use securely compared ( to protect against timing attacks )</li>
<li>token is invalidate after 2 weeks</li>
</ul>

<h2 id="auth-header">Auth Header</h2>

<p>after authenticate ( for example, sign in api call), the header from api response will have
following 5 tags, we call it <code class="prettyprint">Auth Header</code>, client need to extract out <code class="prettyprint">Auth Header</code>,
and insert it in header of next api call. For a exmaple of Auth Header, please have a look at right hand side.</p>

<p>Noted: Any client can easily extract out this <code class="prettyprint">Auth Header</code> exchange logic into a library and shared it out.</p>

<ul>
<li>access-token</li>
<li>token-type</li>
<li>client</li>
<li>expiry</li>
<li>uid</li>
</ul>

<h1 id="app-token">APP TOKEN</h1>

<p>For some public facing api, like patron sign in, patron sign up, request to reset password,  and manager sign in,</p>

<p>it&rsquo;s better to add basic level protection as well, by predefine App Token, and inserting a
<code class="prettyprint">Authorization</code> header with App Token in your request header for public facing api, we can block anonymous attack.</p>

<p>For the correct App Token, please contact admin of Phrenzi.</p>

<blockquote>
<p>Token Authenticated by insert a <code class="prettyprint">Authorization</code> header in your api request, following example is a call to patron sign in with App Token inserted.</p>
</blockquote>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/patrons/sign_in"</span> <span class="se">\</span>
  -H <span class="s2">"ACCEPT: phrenzi.v1"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: app_token"</span>
</code></pre>

<h1 id="link-header-result-pagination">Link Header ( Result pagination )</h1>

<p>For some api, there might to too much data to return in one single response, so we paginate result,
and provide link for <code class="prettyprint">next</code> ( next page ), <code class="prettyprint">prev</code> ( previous page ), or <code class="prettyprint">first</code> ( first page ), and <code class="prettyprint">last</code> ( last page ) in the response header. Consumer of Phrenzi api don&rsquo;t need to construct the api string, everything is under response header, here&rsquo;s an example:</p>
<pre class="highlight shell"><code><span class="gp">$ </span>curl --include <span class="s1">'https://phrenzi.com/managements/patrons?page=5'</span>
HTTP/1.1 200 OK
Link: &lt;http://localhost:3000/movies?page<span class="o">=</span>1&gt;; <span class="nv">rel</span><span class="o">=</span><span class="s2">"first"</span>,
  &lt;http://localhost:3000/movies?page<span class="o">=</span>173&gt;; <span class="nv">rel</span><span class="o">=</span><span class="s2">"last"</span>,
  &lt;http://localhost:3000/movies?page<span class="o">=</span>6&gt;; <span class="nv">rel</span><span class="o">=</span><span class="s2">"next"</span>,
  &lt;http://localhost:3000/movies?page<span class="o">=</span>4&gt;; <span class="nv">rel</span><span class="o">=</span><span class="s2">"prev"</span>
Total: 4321
Per-Page: 10
Page: 5
</code></pre>

<h2 id="header-properties">Header Properties</h2>

<p>there&rsquo;s a few properties in response headers:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Link</td>
<td>the navigation links</td>
</tr>
<tr>
<td>Per-Page</td>
<td>number of result per page</td>
</tr>
<tr>
<td>Page</td>
<td>current page</td>
</tr>
<tr>
<td>Total</td>
<td>Total result</td>
</tr>
</tbody></table>

<h2 id="library-support">Library support</h2>

<p>for iOS: <a href="https://github.com/kylef/WebLinking.swift">WebLinking.swift</a></p>

          <h1 id="json-objects">JSON Objects</h1>

<p>normally, a api response in Phrenzi, will be somehow like this in the right hand side :</p>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"object_name"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"object_attribute_a"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ABCCDD"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object_attribute_b"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Simon"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object_attribute_c"</span><span class="p">:</span><span class="w"> </span><span class="s2">"abc@exmaple.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"object_attribute_d"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1234.22"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>In <code class="prettyprint">object_name</code> tag, it represent the important part for client to consuming, either a json object, or
Array of json objects. It would be easier for us to classify different json object from Phrenzi api
returned, so we list all the different json object here:</p>

<h2 id="patron">Patron</h2>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>UUID</td>
<td>&lsquo;ddbd0c3c-404d-4ce1-9042-9baecb4ef585&rsquo;</td>
<td>uniq identifier of Patron</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>&#39;Simon Iong&rsquo;</td>
<td>the name of Patron</td>
</tr>
<tr>
<td>email</td>
<td>String</td>
<td>&ldquo;abc@example.com&rdquo;</td>
<td>the email from Patron</td>
</tr>
<tr>
<td>credit_balance</td>
<td>String</td>
<td>&#39;123.22&rsquo;</td>
<td>the current avaliable balance by Patron &amp; Establishment</td>
</tr>
<tr>
<td>trans_code</td>
<td>String</td>
<td>&ldquo;asdfw1&rdquo;</td>
<td>6 digit trans code, unique identifier for Patron</td>
</tr>
</tbody></table>

<p>Noted that for every patron, could have different credit_balance in different Establishment</p>

<h2 id="manager">Manager</h2>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>UUID</td>
<td>&#39;ddbd0c3c-404d-4ce1-9042-9baecb4ef585&rsquo;</td>
<td>uniq identifier of Manager</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>&#39;Simon Iong&rsquo;</td>
<td>the name of Manager</td>
</tr>
<tr>
<td>email</td>
<td>String</td>
<td>&#39;abc@example.com&rsquo;</td>
<td>the email from Manager</td>
</tr>
<tr>
<td>establishment_name</td>
<td>String</td>
<td>&#39;Awesome Bar&rsquo;</td>
<td>the establishment name of this Manager</td>
</tr>
</tbody></table>

<h2 id="establishment">Establishment</h2>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>UUID</td>
<td>&#39;ddbd0c3c-404d-4ce1-9042-9baecb4ef585&rsquo;</td>
<td>uniq identifier of Establishment</td>
</tr>
<tr>
<td>name</td>
<td>String</td>
<td>&#39;Awesome Bar&rsquo;</td>
<td>the name of Establishment</td>
</tr>
<tr>
<td>phone</td>
<td>String</td>
<td>&#39;123434123&rsquo;</td>
<td>the phone contact for Establishment</td>
</tr>
<tr>
<td>cash_back</td>
<td>String</td>
<td>&#39;3.5&rsquo;</td>
<td>the current cash back setting</td>
</tr>
<tr>
<td>desc</td>
<td>String</td>
<td>&#39;asdfsad&rsquo;</td>
<td>the desc for Establishment</td>
</tr>
<tr>
<td>logo_url</td>
<td>String</td>
<td>&#39;http://abc.com/logo.img&rsquo;</td>
<td>logo url</td>
</tr>
<tr>
<td>banner_url</td>
<td>String</td>
<td>&#39;http://abc.com/banner.img&rsquo;</td>
<td>logo url</td>
</tr>
<tr>
<td>address</td>
<td>Address object</td>
<td>see below</td>
<td>the address object attached to this establishment</td>
</tr>
<tr>
<td>business_hours</td>
<td>Array of Business Hour</td>
<td>see below</td>
<td>totally 7 business hour object</td>
</tr>
</tbody></table>

<h2 id="address">Address</h2>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>UUID</td>
<td>&#39;ddbd0c3c-404d-4ce1-9042-9baecb4ef585&rsquo;</td>
<td>uniq identifier of Address</td>
</tr>
<tr>
<td>street1</td>
<td>String</td>
<td>&#39;Ma Wan MainRold&rsquo;</td>
<td>the street1 for Establishment</td>
</tr>
<tr>
<td>street2</td>
<td>String</td>
<td>&#39;Ma Wan&rsquo;</td>
<td>the street2 for Establishment</td>
</tr>
<tr>
<td>city</td>
<td>String</td>
<td>&#39;Hong Kong&rsquo;</td>
<td>city for Establishment</td>
</tr>
<tr>
<td>country</td>
<td>String</td>
<td>&#39;HK&rsquo;</td>
<td>country name for ISO 3166-1 standard</td>
</tr>
</tbody></table>

<h2 id="business-hour">Business Hour</h2>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>open_time</td>
<td>Integer</td>
<td>43200</td>
<td>the integer represent the seconds start from mid night, range from 0..86400</td>
</tr>
<tr>
<td>close_time</td>
<td>Integer</td>
<td>63200</td>
<td>the integer represent the seconds start from mid night, range from 0..129600, means, until 12pm next day</td>
</tr>
<tr>
<td>wday</td>
<td>Integer</td>
<td>1</td>
<td>integer represent the day in the week, 0 for sunday, 1 for monday, etc</td>
</tr>
<tr>
<td>closed</td>
<td>Boolean</td>
<td>false</td>
<td>true/false, true stands for establishment is close this day</td>
</tr>
</tbody></table>

<h2 id="transaction">Transaction</h2>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>UUID</td>
<td>&#39;ddbd0c3c-404d-4ce1-9042-9baecb4ef585&rsquo;</td>
<td>uniq identifier of Transaction</td>
</tr>
<tr>
<td>patron_id</td>
<td>UUID</td>
<td>&#39;eebd0c3c-404d-4ce1-9042-9baecb4ef585&rsquo;</td>
<td>UUID for patron</td>
</tr>
<tr>
<td>establishment_id</td>
<td>UUID</td>
<td>&#39;ffbd0c3c-404d-4ce1-9042-9baecb4ef585&rsquo;</td>
<td>UUID for establishment</td>
</tr>
<tr>
<td>challenge_id</td>
<td>UUID</td>
<td>&#39;ffbd0c3c-404d-4ce1-9042-9baecb4ef585&rsquo;</td>
<td>UUID for challenge, can be NILL</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td>&#39;sale&rsquo;</td>
<td>type of transaction, either &#39;sale&rsquo;, or &#39;credit&rsquo;, or &#39;correction&rsquo;</td>
</tr>
<tr>
<td>sale_amount</td>
<td>String</td>
<td>&#39;200.00&rsquo;</td>
<td>different meaning for different scenarios</td>
</tr>
<tr>
<td>applied_credit</td>
<td>String</td>
<td>&#39;7.00&rsquo;</td>
<td>the applied credit to used from credit account</td>
</tr>
<tr>
<td>sales_credit</td>
<td>String</td>
<td>&#39;7.00&rsquo;</td>
<td>the cash-back from sales_amount</td>
</tr>
<tr>
<td>credit_subtotal</td>
<td>String</td>
<td>&#39;7.00&rsquo;</td>
<td>sales_credit - applied_credit</td>
</tr>
<tr>
<td>remaining_credit</td>
<td>String</td>
<td>&#39;7.00&rsquo;</td>
<td>at the timing of create transaction, the credit_balance in credit account</td>
</tr>
<tr>
<td>tracked_at</td>
<td>Datetime</td>
<td>&ldquo;2016-06-04T07:48:56.050Z&rdquo;</td>
<td>ISO_8601 format datetime string</td>
</tr>
<tr>
<td>deleted</td>
<td>Boolean</td>
<td>true</td>
<td>true means this transaction is already been deleted</td>
</tr>
<tr>
<td>deleted_at</td>
<td>Datetime</td>
<td>&ldquo;2016-06-05T07:48:56.050Z&rdquo;</td>
<td>ISO_8601 format datetime string, the timestamp that this transaction is being deleted</td>
</tr>
<tr>
<td>del_transaction_id</td>
<td>UUID</td>
<td>&ldquo;ggbd0c3c-404d-4ce1-9042-9baecb4ef585&rdquo;</td>
<td>UUID of origin delete transaction</td>
</tr>
<tr>
<td>action</td>
<td>String</td>
<td>&#39;Cash Purchase&rsquo;</td>
<td>action name for transaction</td>
</tr>
</tbody></table>

<p>NOTED:</p>

<ul>
<li>if a transaction A is deleted by api, then a reverted transaction B is created. Both transaction A &amp; B exists in Database, transaction A is called <code class="prettyprint">origin deleted transaction</code>, transaction B is called <code class="prettyprint">reverted deleted transaction</code></li>
<li>server response json object order by tracked_at descending order.</li>
<li>Client identify <code class="prettyprint">reverted deleted transaction</code> by <code class="prettyprint">deleted_at</code>.

<ul>
<li>If transaction <code class="prettyprint">deleted_at</code> is present, means that this transaction is <code class="prettyprint">reverted deleted transaction</code>, one can reference <code class="prettyprint">origin deleted transaction</code> by <code class="prettyprint">del_transaction_id</code></li>
<li><code class="prettyprint">reverted deleted transaction</code> and <code class="prettyprint">origin deleted transaction</code> have the same <code class="prettyprint">tracked_at</code></li>
<li>If <code class="prettyprint">deleted_at</code> is populated, then <code class="prettyprint">deleted</code> should be true</li>
<li>if <code class="prettyprint">deleted_at</code> is populated, and client need to display datetime of this record somewhere, then should use <code class="prettyprint">deleted_at</code> instead of <code class="prettyprint">tracked_at</code>.</li>
</ul></li>
<li>if transaction <code class="prettyprint">deleted</code> is false, means client call <code class="prettyprint">delete transaction</code> api to delete this transaction</li>
</ul>

<h3 id="scenario-1-fully-sale-record">Scenario 1: fully sale record:</h3>

<p>sale amount is 200, cash_back setting is 3.5%, then earned credit 7.00</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>UUID</td>
<td>&#39;abcd&rsquo;</td>
<td>UUID of transaction</td>
</tr>
<tr>
<td>patron_id</td>
<td>UUID</td>
<td>&#39;ADSSDD&rsquo;</td>
<td>UUID of patron</td>
</tr>
<tr>
<td>establishment_id</td>
<td>UUID</td>
<td>&#39;ADSSDD&rsquo;</td>
<td>UUID of establishment</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td>&#39;sale&rsquo;</td>
<td>type of transaction, either &#39;sale&rsquo;, or &#39;credit&rsquo;, or &#39;correction&rsquo;</td>
</tr>
<tr>
<td>sale_amount</td>
<td>String</td>
<td>&#39;200.00&rsquo;</td>
<td>the sale amount of this transaction</td>
</tr>
<tr>
<td>applied_credit</td>
<td>String</td>
<td>&#39;0.00&rsquo;</td>
<td>the applied credit from credit account</td>
</tr>
<tr>
<td>sales_crecit</td>
<td>String</td>
<td>&#39;7.00&rsquo;</td>
<td>the credit patron get from this transaction</td>
</tr>
<tr>
<td>credit_subtotal</td>
<td>String</td>
<td>&#39;7.00&rsquo;</td>
<td>total credit earned from this transaction</td>
</tr>
<tr>
<td>remaining_credit</td>
<td>String</td>
<td>&#39;7.00&rsquo;</td>
<td>after create this transaction, total balance in credit account</td>
</tr>
<tr>
<td>tracked_at</td>
<td>Datetime</td>
<td>&ldquo;2016-06-04T07:48:56.050Z&rdquo;</td>
<td>ISO_8601 format datetime string</td>
</tr>
<tr>
<td>deleted_at</td>
<td>Datetime</td>
<td>null</td>
<td></td>
</tr>
<tr>
<td>deleted</td>
<td>Boolean</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td>del_transaction_id</td>
<td>UUID</td>
<td>null</td>
<td></td>
</tr>
<tr>
<td>action</td>
<td>String</td>
<td>&#39;Cash Purchase&rsquo;</td>
<td></td>
</tr>
</tbody></table>

<h3 id="scenario-2-partially-credit-redeem">Scenario 2: Partially credit redeem:</h3>

<p>sale amount is 200, 125 credit redeemed, then sale &amp; credit record would be:</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>UUID</td>
<td>&#39;abcde&rsquo;</td>
<td>UUID of transaction</td>
</tr>
<tr>
<td>patron_id</td>
<td>UUID</td>
<td>&#39;ADSSDD&rsquo;</td>
<td>UUID of patron</td>
</tr>
<tr>
<td>establishment_id</td>
<td>UUID</td>
<td>&#39;ADSSDD&rsquo;</td>
<td>UUID of establishment</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td>&#39;sale&rsquo;</td>
<td>type of transaction</td>
</tr>
<tr>
<td>sale_amount</td>
<td>String</td>
<td>&#39;75.00&rsquo;</td>
<td>in this case, we deduct 125 credit</td>
</tr>
<tr>
<td>applied_credit</td>
<td>String</td>
<td>&#39;0.00&rsquo;</td>
<td>the applied credit from credit account</td>
</tr>
<tr>
<td>sales_crecit</td>
<td>String</td>
<td>&#39;2.6&rsquo;</td>
<td>75 * 0.035 = 2.625 ~&gt; 2.6</td>
</tr>
<tr>
<td>credit_subtotal</td>
<td>String</td>
<td>&#39;2.6&rsquo;</td>
<td>total credit earned from this transaction</td>
</tr>
<tr>
<td>remaining_credit</td>
<td>String</td>
<td>&#39;202.60&rsquo;</td>
<td>after create this transaction, total balance in credit account</td>
</tr>
<tr>
<td>tracked_at</td>
<td>Datetime</td>
<td>&ldquo;2016-06-04T07:48:56.050Z&rdquo;</td>
<td>ISO_8601 format datetime string</td>
</tr>
<tr>
<td>deleted_at</td>
<td>Datetime</td>
<td>null</td>
<td></td>
</tr>
<tr>
<td>deleted</td>
<td>Boolean</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td>del_transaction_id</td>
<td>UUID</td>
<td>null</td>
<td></td>
</tr>
<tr>
<td>action</td>
<td>String</td>
<td>&#39;Cash Purchase&rsquo;</td>
<td></td>
</tr>
</tbody></table>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>UUID</td>
<td>&#39;abcdf&rsquo;</td>
<td>UUID of transaction</td>
</tr>
<tr>
<td>patron_id</td>
<td>UUID</td>
<td>&#39;ADSSDD&rsquo;</td>
<td>UUID of patron</td>
</tr>
<tr>
<td>establishment_id</td>
<td>UUID</td>
<td>&#39;ADSSDD&rsquo;</td>
<td>UUID of establishment</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td>&#39;credit&rsquo;</td>
<td>type of transaction</td>
</tr>
<tr>
<td>sale_amount</td>
<td>String</td>
<td>&#39;125.00&rsquo;</td>
<td>the sale amount redeem by credit</td>
</tr>
<tr>
<td>applied_credit</td>
<td>String</td>
<td>&rsquo;-125.00&rsquo;</td>
<td>the applied credit from credit account</td>
</tr>
<tr>
<td>sales_crecit</td>
<td>String</td>
<td>&#39;4.4&rsquo;</td>
<td>125 * 0.035 = 4.375 ~&gt; 4.4</td>
</tr>
<tr>
<td>credit_subtotal</td>
<td>String</td>
<td>&rsquo;-120.6&rsquo;</td>
<td>total credit earned from this transaction</td>
</tr>
<tr>
<td>remaining_credit</td>
<td>String</td>
<td>&#39;82.00&rsquo;</td>
<td>after create this transaction, total balance in credit account</td>
</tr>
<tr>
<td>tracked_at</td>
<td>Datetime</td>
<td>&ldquo;2016-06-04T07:48:56.050Z&rdquo;</td>
<td>ISO_8601 format datetime string</td>
</tr>
<tr>
<td>deleted_at</td>
<td>Datetime</td>
<td>null</td>
<td></td>
</tr>
<tr>
<td>deleted</td>
<td>Boolean</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td>del_transaction_id</td>
<td>UUID</td>
<td>null</td>
<td></td>
</tr>
<tr>
<td>action</td>
<td>String</td>
<td>&#39;Credit Purchase&rsquo;</td>
<td></td>
</tr>
</tbody></table>

<h3 id="scenario-3-fully-credit-redeem">Scenario 3: Fully credit redeem:</h3>

<p>sale amount is 200, 200 credit redeemed, then there is no sale record, only credit record.</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>UUID</td>
<td>&#39;abcdg&rsquo;</td>
<td>UUID of transaction</td>
</tr>
<tr>
<td>patron_id</td>
<td>UUID</td>
<td>&#39;ADSSDD&rsquo;</td>
<td>UUID of patron</td>
</tr>
<tr>
<td>establishment_id</td>
<td>UUID</td>
<td>&#39;ADSSDD&rsquo;</td>
<td>UUID of establishment</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td>&#39;credit&rsquo;</td>
<td>type of transaction</td>
</tr>
<tr>
<td>sale_amount</td>
<td>String</td>
<td>&#39;200.00&rsquo;</td>
<td>the sale amount redeem by credit</td>
</tr>
<tr>
<td>applied_credit</td>
<td>String</td>
<td>&rsquo;-200.00&rsquo;</td>
<td>the applied credit from credit account</td>
</tr>
<tr>
<td>sales_crecit</td>
<td>String</td>
<td>&#39;7.0&rsquo;</td>
<td>200 * 0.035 = 7</td>
</tr>
<tr>
<td>credit_subtotal</td>
<td>String</td>
<td>&rsquo;-193.0&rsquo;</td>
<td>total credit earned from this transaction</td>
</tr>
<tr>
<td>remaining_credit</td>
<td>String</td>
<td>&#39;7.00&rsquo;</td>
<td>after create this transaction, total balance in credit account</td>
</tr>
<tr>
<td>tracked_at</td>
<td>Datetime</td>
<td>&ldquo;2016-06-04T07:48:56.050Z&rdquo;</td>
<td>ISO_8601 format datetime string</td>
</tr>
<tr>
<td>deleted_at</td>
<td>Datetime</td>
<td>null</td>
<td></td>
</tr>
<tr>
<td>deleted</td>
<td>Boolean</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td>del_transaction_id</td>
<td>UUID</td>
<td>null</td>
<td></td>
</tr>
<tr>
<td>action</td>
<td>String</td>
<td>&#39;Credit Purchase&rsquo;</td>
<td></td>
</tr>
</tbody></table>

<h3 id="scenario-4-credit-correct">Scenario 4: Credit correct:</h3>

<p>manager decide to deduct 200 credit balance for Patron.</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>UUID</td>
<td>&#39;abcdh&rsquo;</td>
<td>UUID of transaction</td>
</tr>
<tr>
<td>patron_id</td>
<td>UUID</td>
<td>&#39;ADSSDD&rsquo;</td>
<td>UUID of patron</td>
</tr>
<tr>
<td>establishment_id</td>
<td>UUID</td>
<td>&#39;ADSSDD&rsquo;</td>
<td>UUID of establishment</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td>&#39;correction&rsquo;</td>
<td>type of transaction</td>
</tr>
<tr>
<td>sale_amount</td>
<td>String</td>
<td>&#39;0.00&rsquo;</td>
<td>the sale amount redeem by credit</td>
</tr>
<tr>
<td>applied_credit</td>
<td>String</td>
<td>&#39;0.00&rsquo;</td>
<td>the applied credit from credit account</td>
</tr>
<tr>
<td>sales_crecit</td>
<td>String</td>
<td>&#39;0.0&rsquo;</td>
<td>cash-back generated from sales_amount</td>
</tr>
<tr>
<td>credit_subtotal</td>
<td>String</td>
<td>&rsquo;-200.00&rsquo;</td>
<td>total credit earned from this transaction</td>
</tr>
<tr>
<td>remaining_credit</td>
<td>String</td>
<td>&#39;100.00&rsquo;</td>
<td>after create this transaction, total balance in credit account</td>
</tr>
<tr>
<td>tracked_at</td>
<td>Datetime</td>
<td>&ldquo;2016-06-04T07:48:56.050Z&rdquo;</td>
<td>ISO_8601 format datetime string</td>
</tr>
<tr>
<td>deleted_at</td>
<td>Datetime</td>
<td>null</td>
<td></td>
</tr>
<tr>
<td>deleted</td>
<td>Boolean</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td>del_transaction_id</td>
<td>UUID</td>
<td>null</td>
<td></td>
</tr>
<tr>
<td>action</td>
<td>String</td>
<td>&#39;Credit Correciton&rsquo;</td>
<td></td>
</tr>
</tbody></table>

<h3 id="scenario-5-delete-full-sale-record-from-scenario-1">Scenario 5: Delete Full Sale Record from Scenario 1</h3>

<p>Original Sale transaction</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>UUID</td>
<td>&#39;abcd&rsquo;</td>
<td>UUID of transaction</td>
</tr>
<tr>
<td>patron_id</td>
<td>UUID</td>
<td>&#39;ADSSDD&rsquo;</td>
<td>UUID of patron</td>
</tr>
<tr>
<td>establishment_id</td>
<td>UUID</td>
<td>&#39;ADSSDD&rsquo;</td>
<td>UUID of establishment</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td>&#39;sale&rsquo;</td>
<td>type of transaction, either &#39;sale&rsquo;, or &#39;credit&rsquo;, or &#39;correction&rsquo;</td>
</tr>
<tr>
<td>sale_amount</td>
<td>String</td>
<td>&#39;200.00&rsquo;</td>
<td>the sale amount of this transaction</td>
</tr>
<tr>
<td>applied_credit</td>
<td>String</td>
<td>&#39;0.00&rsquo;</td>
<td>the applied credit from credit account</td>
</tr>
<tr>
<td>sales_crecit</td>
<td>String</td>
<td>&#39;7.00&rsquo;</td>
<td>the credit patron get from this transaction</td>
</tr>
<tr>
<td>credit_subtotal</td>
<td>String</td>
<td>&#39;7.00&rsquo;</td>
<td>total credit earned from this transaction</td>
</tr>
<tr>
<td>remaining_credit</td>
<td>String</td>
<td>&#39;7.00&rsquo;</td>
<td>after create this transaction, total balance in credit account</td>
</tr>
<tr>
<td>tracked_at</td>
<td>Datetime</td>
<td>&ldquo;2016-06-04T07:48:56.050Z&rdquo;</td>
<td>ISO_8601 format datetime string</td>
</tr>
<tr>
<td>deleted_at</td>
<td>Datetime</td>
<td>null</td>
<td></td>
</tr>
<tr>
<td>deleted</td>
<td>Boolean</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td>del_transaction_id</td>
<td>UUID</td>
<td>null</td>
<td></td>
</tr>
<tr>
<td>action</td>
<td>String</td>
<td>&#39;Cash Purchase&rsquo;</td>
<td></td>
</tr>
</tbody></table>

<p>Reverted Sale transaction</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>UUID</td>
<td>&#39;abcd2&rsquo;</td>
<td>UUID of transaction</td>
</tr>
<tr>
<td>patron_id</td>
<td>UUID</td>
<td>&#39;ADSSDD&rsquo;</td>
<td>UUID of patron</td>
</tr>
<tr>
<td>establishment_id</td>
<td>UUID</td>
<td>&#39;ADSSDD&rsquo;</td>
<td>UUID of establishment</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td>&#39;sale&rsquo;</td>
<td>type of transaction, either &#39;sale&rsquo;, or &#39;credit&rsquo;, or &#39;correction&rsquo;</td>
</tr>
<tr>
<td>sale_amount</td>
<td>String</td>
<td>&rsquo;-200.00&rsquo;</td>
<td>the sale amount of this transaction</td>
</tr>
<tr>
<td>applied_credit</td>
<td>String</td>
<td>&#39;0.00&rsquo;</td>
<td>the applied credit from credit account</td>
</tr>
<tr>
<td>sales_crecit</td>
<td>String</td>
<td>&rsquo;-7.00&rsquo;</td>
<td>the credit patron get from this transaction</td>
</tr>
<tr>
<td>credit_subtotal</td>
<td>String</td>
<td>&rsquo;-7.00&rsquo;</td>
<td>total credit earned from this transaction</td>
</tr>
<tr>
<td>remaining_credit</td>
<td>String</td>
<td>&#39;100.00&rsquo;</td>
<td>after create this transaction, total balance in credit account</td>
</tr>
<tr>
<td>tracked_at</td>
<td>Datetime</td>
<td>&ldquo;2016-06-04T07:48:56.050Z&rdquo;</td>
<td>ISO_8601 format datetime string</td>
</tr>
<tr>
<td>deleted_at</td>
<td>Datetime</td>
<td>&ldquo;2016-06-05T07:48:56.050Z&rdquo;</td>
<td></td>
</tr>
<tr>
<td>deleted</td>
<td>Boolean</td>
<td>true</td>
<td></td>
</tr>
<tr>
<td>del_transaction_id</td>
<td>UUID</td>
<td>&ldquo;abcd&rdquo;</td>
<td></td>
</tr>
<tr>
<td>action</td>
<td>String</td>
<td>&#39;Cash Purchase Deletion&rsquo;</td>
<td></td>
</tr>
</tbody></table>

<h3 id="scenario-6-delete-partial-sale-record-from-scenario-2">Scenario 6: Delete Partial Sale Record from Scenario 2</h3>

<p>Original Sale Transaction</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>UUID</td>
<td>&#39;abcde&rsquo;</td>
<td>UUID of transaction</td>
</tr>
<tr>
<td>patron_id</td>
<td>UUID</td>
<td>&#39;ADSSDD&rsquo;</td>
<td>UUID of patron</td>
</tr>
<tr>
<td>establishment_id</td>
<td>UUID</td>
<td>&#39;ADSSDD&rsquo;</td>
<td>UUID of establishment</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td>&#39;sale&rsquo;</td>
<td>type of transaction</td>
</tr>
<tr>
<td>sale_amount</td>
<td>String</td>
<td>&#39;75.00&rsquo;</td>
<td>in this case, we deduct 125 credit</td>
</tr>
<tr>
<td>applied_credit</td>
<td>String</td>
<td>&#39;0.00&rsquo;</td>
<td>the applied credit from credit account</td>
</tr>
<tr>
<td>sales_crecit</td>
<td>String</td>
<td>&#39;2.6&rsquo;</td>
<td>75 * 0.035 = 2.625 ~&gt; 2.6</td>
</tr>
<tr>
<td>credit_subtotal</td>
<td>String</td>
<td>&#39;2.6&rsquo;</td>
<td>total credit earned from this transaction</td>
</tr>
<tr>
<td>remaining_credit</td>
<td>String</td>
<td>&#39;202.60&rsquo;</td>
<td>after create this transaction, total balance in credit account</td>
</tr>
<tr>
<td>tracked_at</td>
<td>Datetime</td>
<td>&ldquo;2016-06-04T07:48:56.050Z&rdquo;</td>
<td>ISO_8601 format datetime string</td>
</tr>
<tr>
<td>deleted_at</td>
<td>Datetime</td>
<td>null</td>
<td></td>
</tr>
<tr>
<td>deleted</td>
<td>Boolean</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td>del_transaction_id</td>
<td>UUID</td>
<td>null</td>
<td></td>
</tr>
<tr>
<td>action</td>
<td>String</td>
<td>&#39;Cash Purchase&rsquo;</td>
<td></td>
</tr>
</tbody></table>

<p>Original Credit Transaction</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>UUID</td>
<td>&#39;abcdf&rsquo;</td>
<td>UUID of transaction</td>
</tr>
<tr>
<td>patron_id</td>
<td>UUID</td>
<td>&#39;ADSSDD&rsquo;</td>
<td>UUID of patron</td>
</tr>
<tr>
<td>establishment_id</td>
<td>UUID</td>
<td>&#39;ADSSDD&rsquo;</td>
<td>UUID of establishment</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td>&#39;credit&rsquo;</td>
<td>type of transaction</td>
</tr>
<tr>
<td>sale_amount</td>
<td>String</td>
<td>&#39;125.00&rsquo;</td>
<td>the sale amount redeem by credit</td>
</tr>
<tr>
<td>applied_credit</td>
<td>String</td>
<td>&rsquo;-125.00&rsquo;</td>
<td>the applied credit from credit account</td>
</tr>
<tr>
<td>sales_crecit</td>
<td>String</td>
<td>&#39;4.4&rsquo;</td>
<td>125 * 0.035 = 4.375 ~&gt; 4.4</td>
</tr>
<tr>
<td>credit_subtotal</td>
<td>String</td>
<td>&rsquo;-120.6&rsquo;</td>
<td>total credit earned from this transaction</td>
</tr>
<tr>
<td>remaining_credit</td>
<td>String</td>
<td>&#39;82.00&rsquo;</td>
<td>after create this transaction, total balance in credit account</td>
</tr>
<tr>
<td>tracked_at</td>
<td>Datetime</td>
<td>&ldquo;2016-06-04T07:48:56.050Z&rdquo;</td>
<td>ISO_8601 format datetime string</td>
</tr>
<tr>
<td>deleted_at</td>
<td>Datetime</td>
<td>null</td>
<td></td>
</tr>
<tr>
<td>deleted</td>
<td>Boolean</td>
<td>false</td>
<td></td>
</tr>
<tr>
<td>del_transaction_id</td>
<td>UUID</td>
<td>null</td>
<td></td>
</tr>
<tr>
<td>action</td>
<td>String</td>
<td>&#39;Credit Purchase&rsquo;</td>
<td></td>
</tr>
</tbody></table>

<p>Reverted Sale transaction</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>UUID</td>
<td>&#39;abcde2&rsquo;</td>
<td>UUID of transaction</td>
</tr>
<tr>
<td>patron_id</td>
<td>UUID</td>
<td>&#39;ADSSDD&rsquo;</td>
<td>UUID of patron</td>
</tr>
<tr>
<td>establishment_id</td>
<td>UUID</td>
<td>&#39;ADSSDD&rsquo;</td>
<td>UUID of establishment</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td>&#39;sale&rsquo;</td>
<td>type of transaction</td>
</tr>
<tr>
<td>sale_amount</td>
<td>String</td>
<td>&rsquo;-75.00&rsquo;</td>
<td>in this case, we deduct 125 credit</td>
</tr>
<tr>
<td>applied_credit</td>
<td>String</td>
<td>&#39;0.00&rsquo;</td>
<td>the applied credit from credit account</td>
</tr>
<tr>
<td>sales_crecit</td>
<td>String</td>
<td>&rsquo;-2.6&rsquo;</td>
<td>75 * 0.035 = 2.625 ~&gt; 2.6</td>
</tr>
<tr>
<td>credit_subtotal</td>
<td>String</td>
<td>&rsquo;-2.6&rsquo;</td>
<td>total credit earned from this transaction</td>
</tr>
<tr>
<td>remaining_credit</td>
<td>String</td>
<td>&#39;152.6&rsquo;</td>
<td>after create this transaction, total balance in credit account</td>
</tr>
<tr>
<td>tracked_at</td>
<td>Datetime</td>
<td>&ldquo;2016-06-04T07:48:56.050Z&rdquo;</td>
<td>ISO_8601 format datetime string</td>
</tr>
<tr>
<td>deleted_at</td>
<td>Datetime</td>
<td>&ldquo;2016-06-05T07:48:56.050Z&rdquo;</td>
<td></td>
</tr>
<tr>
<td>deleted</td>
<td>Boolean</td>
<td>true</td>
<td></td>
</tr>
<tr>
<td>del_transaction_id</td>
<td>UUID</td>
<td>&#39;abcde&rsquo;</td>
<td></td>
</tr>
<tr>
<td>action</td>
<td>String</td>
<td>&#39;Cash Purchase Deletion&rsquo;</td>
<td></td>
</tr>
</tbody></table>

<p>Reverted Credit transaction</p>

<table><thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>UUID</td>
<td>&#39;abcdf2&rsquo;</td>
<td>UUID of transaction</td>
</tr>
<tr>
<td>patron_id</td>
<td>UUID</td>
<td>&#39;ADSSDD&rsquo;</td>
<td>UUID of patron</td>
</tr>
<tr>
<td>establishment_id</td>
<td>UUID</td>
<td>&#39;ADSSDD&rsquo;</td>
<td>UUID of establishment</td>
</tr>
<tr>
<td>type</td>
<td>String</td>
<td>&#39;credit&rsquo;</td>
<td>type of transaction</td>
</tr>
<tr>
<td>sale_amount</td>
<td>String</td>
<td>&rsquo;-125.00&rsquo;</td>
<td>the sale amount redeem by credit</td>
</tr>
<tr>
<td>applied_credit</td>
<td>String</td>
<td>&#39;125.00&rsquo;</td>
<td>the applied credit from credit account</td>
</tr>
<tr>
<td>sales_crecit</td>
<td>String</td>
<td>&rsquo;-4.4&rsquo;</td>
<td>125 * 0.035 = 4.375 ~&gt; 4.4</td>
</tr>
<tr>
<td>credit_subtotal</td>
<td>String</td>
<td>&#39;120.6&rsquo;</td>
<td>total credit earned from this transaction</td>
</tr>
<tr>
<td>remaining_credit</td>
<td>String</td>
<td>&#39;273.2&rsquo;</td>
<td>after create this transaction, total balance in credit account</td>
</tr>
<tr>
<td>tracked_at</td>
<td>Datetime</td>
<td>&ldquo;2016-06-04T07:48:56.050Z&rdquo;</td>
<td>ISO_8601 format datetime string</td>
</tr>
<tr>
<td>deleted_at</td>
<td>Datetime</td>
<td>&ldquo;2016-06-05T07:48:56.050Z&rdquo;</td>
<td></td>
</tr>
<tr>
<td>deleted</td>
<td>Boolean</td>
<td>true</td>
<td></td>
</tr>
<tr>
<td>del_transaction_id</td>
<td>UUID</td>
<td>&#39;abcdf&rsquo;</td>
<td></td>
</tr>
<tr>
<td>action</td>
<td>String</td>
<td>&#39;Credit Purchase Deletion&rsquo;</td>
<td></td>
</tr>
</tbody></table>

          <h1 id="patrons">Patrons</h1>

<h2 id="sign-up">Sign Up</h2>
<pre class="highlight shell"><code>curl <span class="s2">"http://phrenzi.com/api/patrons"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: app_token"</span> <span class="se">\</span>
  -X POST <span class="se">\</span>
  -d <span class="s1">'{
        "name": "Simon",
        "email": "abc@gmail.com",
        "password": "password",
        "password_confirmation": "password",
        "confirm_success_url": "phrenzi://"
        }'</span>
</code></pre>

<blockquote>
<p>if success, the above command returns HTTP Status Code <code class="prettyprint">200</code> with following json objects:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"patron"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"37f335c5-a88c-41a3-a643-fba688c72897"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Simon"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"abc@example.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"trans_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8cc897"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>if failed, the above command returns HTTP Status Code <code class="prettyprint">422</code> with following json objects:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"already in use"</span><span class="p">],</span><span class="w">
    </span><span class="nt">"full_messages"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Email already in use"</span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint try to register a account for Patron, and need App Token authenticate.</p>

<ul>
<li>if success, it will return HTTP Status Code <code class="prettyprint">200</code> with <code class="prettyprint">Patron</code> json object</li>
<li>if failed, it will return HTTP Status Code <code class="prettyprint">422</code>, and with <code class="prettyprint">errors</code> json message</li>
</ul>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST http://phrenzi.com/api/patrons</code></p>

<h3 id="url-parameters">URL Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td>the name of patron</td>
</tr>
<tr>
<td>email</td>
<td>the email of patron</td>
</tr>
<tr>
<td>password</td>
<td>the password of patron account</td>
</tr>
<tr>
<td>password_confirmation</td>
<td>confirm password again</td>
</tr>
<tr>
<td>confirm_success_url</td>
<td>the url after confirmation link is click</td>
</tr>
</tbody></table>

<h2 id="sign-in">Sign In</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/patrons/sign_in"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: app_token"</span> <span class="se">\</span>
  -X POST <span class="se">\</span>
  -d <span class="s1">'{
        "email": "abc@gmail.com",
        "password": "password" }'</span>
</code></pre>

<blockquote>
<p>if success, the above command returns <code class="prettyprint">Patron</code> object with <code class="prettyprint">200</code> status code, and structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"patron"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"288f4f0f-da30-45c4-a531-c0a804628395"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Simon"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"abc@gmail.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"trans_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"76efd7"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>if failed, the above command returns status code <code class="prettyprint">401</code> and json structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"Invalid login credentials. Please try again."</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>if patron is not confirmed yet, return status code <code class="prettyprint">401</code> and json like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"A confirmation email was sent to your account at 'abc@gmail.com'. You must follow the instructions in the email before your account can be activated"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint try to authenticate Patron, and need App Token authenticate.</p>

<ul>
<li>if success, it will return <code class="prettyprint">Patron</code> object with HTTP Status Code <code class="prettyprint">200</code>, and client can retrive
auth header from reponse to consuming next request that need authentication.</li>
<li>if failed to authenticate, it will return HTTP Status Code <code class="prettyprint">401</code> with <code class="prettyprint">errors</code> message.</li>
</ul>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST http://example.com/api/patrons/sign_in</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>email</td>
<td>the email of patron account</td>
</tr>
<tr>
<td>password</td>
<td>the password of patron account</td>
</tr>
</tbody></table>

<h2 id="sign-out">Sign Out</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/patrons/sign_out"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"access-token: token"</span> <span class="se">\</span>
  -H <span class="s2">"token-type: Bearer"</span> <span class="se">\</span>
  -H <span class="s2">"client: u4N6u_toFnoDR1o318uOVA"</span> <span class="se">\</span>
  -H <span class="s2">"expiry: 1466692376"</span> <span class="se">\</span>
  -H <span class="s2">"uid: abc@example.com"</span>
  -X DELETE
</code></pre>

<blockquote>
<p>if success, the above command returns status code <code class="prettyprint">200</code>, and json object like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>if failed, the above command returns status code <code class="prettyprint">404</code>, and errors json like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"User was not found or was not logged in."</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>this endpoint need <code class="prettyprint">Auth Header</code> to authenticate patron,
you are going to get it from Patron <code class="prettyprint">Sign In</code> api request
or other subsequence request that need authentication.</p>

<ul>
<li>if success, it will return HTTP Status Code <code class="prettyprint">200</code></li>
<li>if failed to authenticate, it will return HTTP Status Code <code class="prettyprint">404</code> with <code class="prettyprint">errors</code> message.</li>
</ul>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">DELETE http://example.com/api/patrons/sign_out</code></p>

<h2 id="confirmation-patron">Confirmation Patron</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/patrons/confirmation"</span> <span class="se">\</span>
  -X GET
  -d <span class="s1">'{
    "confirmation_token": "abcasdfasd",
    "redirect_url": "phrenzi://",
    "config": "default"
    }'</span>
</code></pre>

<blockquote>
<p>if success, it will redirect to the <code class="prettyprint">redirect_url</code> specify in this api</p>

<p>if failed, it will raise an exception ActionController::RoutingError</p>
</blockquote>

<p>during sign up procedure of patron ( client call Patron sign up API ),
server will sent out a confirmation email to Patron&rsquo;s mailbox,
patron will need to click a link in that email,
there&rsquo;s a generated confirmation_token in there, which will be use to call
in this endpoint.</p>

<aside class="warning">Client don&rsquo;t need to call this API.</aside>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://example.com/api/patrons/confirmation</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>confirmation_token</td>
<td>the confirmation token for patron</td>
</tr>
<tr>
<td>redirect_url</td>
<td>the params is pass-in from patron sign up API</td>
</tr>
<tr>
<td>config</td>
<td>the config object, which is <code class="prettyprint">default</code></td>
</tr>
</tbody></table>

<h2 id="request-reset-password">Request Reset Password</h2>
<pre class="highlight shell"><code>curl <span class="s2">"http://example.com/api/patrons/password"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: app_token"</span> <span class="se">\</span>
  -X POST <span class="se">\</span>
  -d <span class="s1">'{
        "email": "abc@gmail.com" }'</span>
        <span class="s2">"redirect_url"</span>: <span class="s2">"phrenzi://"</span> <span class="o">}</span><span class="s1">'
</span></code></pre>

<blockquote>
<p>if success, return HTTP Status Code <code class="prettyprint">200</code> without following json object</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"An email has been sent to 'abc@gmail.com' containing instructions for resetting your password."</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>if email not found, return HTTP Status Code `404, with following json object</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"Unable to find user with email 'abc@gmail.com.'"</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>if email is missing, return HTTP Status Code <code class="prettyprint">401</code>, with following json object</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"You must provide an email address."</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>if redirect_url is missing, return HTTP Status Code <code class="prettyprint">401</code>, with following json object</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"Missing redirect URL."</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This api need App Token authenticated and is used while Patron forget password, and after this api is invoked and is success, a email
will trigger and sent to Patron&rsquo;s registered email.</p>

<ul>
<li>if success, it will return HTTP Status Code <code class="prettyprint">200</code> without json object</li>
<li>if email is missing, it will return HTTP Status Code <code class="prettyprint">401</code></li>
<li>if redirect_url is missing, it will return HTTP Status Code <code class="prettyprint">401</code></li>
<li>if email is not found in server, it will return HTTP Status Code <code class="prettyprint">404</code></li>
</ul>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST http://phrenzi.com/api/patrons/password</code></p>

<h3 id="url-parameters">URL Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>email</td>
<td>the email of patron</td>
</tr>
<tr>
<td>redirect_url</td>
<td>the url that is used within reset password email to redirect back to app</td>
</tr>
</tbody></table>

<h2 id="password-reset-link">Password Reset Link</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/patrons/password/edit"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -X GET <span class="se">\</span>
  -d <span class="s1">'{
    "reset_password_token": "abcasdfasd",
    "redirect_url": "phrenzi://"
    }'</span>
</code></pre>

<blockquote>
<p>if success, it will redirect to the <code class="prettyprint">redirect_url</code> specify in this api</p>

<p>if failed, it will raise an exception ActionController::RoutingError</p>
</blockquote>

<p>during password reset procedure of patron ( client call Patron request password reset API ), server
will sent out a password reset email to Patron&rsquo;s mailbox,
patron will need to click a link in that email,
which will trigger this call if Patron click that link.
If every thing is fine, Patron will redirect to app,
with <code class="prettyprint">auth header</code> in a request, then App can
retrieve <code class="prettyprint">auth header</code> from that redirect request.</p>

<aside class="warning">Client don&rsquo;t need to call this API.</aside>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://phrenzi.com/api/patrons/password/edit</code></p>

<h3 id="url-parameters">URL Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>reset_password_token</td>
<td>reset password token</td>
</tr>
<tr>
<td>redirect_url</td>
<td>a link to redirect back after success operation</td>
</tr>
</tbody></table>

<h2 id="update-password">Update Password</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/patrons/password"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"access-token: token"</span> <span class="se">\</span>
  -H <span class="s2">"token-type: Bearer"</span> <span class="se">\</span>
  -H <span class="s2">"client: u4N6u_toFnoDR1o318uOVA"</span> <span class="se">\</span>
  -H <span class="s2">"expiry: 1466692376"</span> <span class="se">\</span>
  -H <span class="s2">"uid: abc@example.com"</span> <span class="se">\</span>
  -X PATCH <span class="se">\</span>
  -d <span class="s1">'{
    "password": "new_password",
    "password_confirmation": "new_password"
    }'</span>
</code></pre>

<blockquote>
<p>if success, it will response with http status code <code class="prettyprint">200</code>, and with following json object</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nt">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Your password has been successfully updated."</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>if failed, for example, password mismatch, response with http status code <code class="prettyprint">422</code>,
and with following json object</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"password_confirmation"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"doesn't match Password"</span><span class="p">],</span><span class="w">
    </span><span class="nt">"full_messages"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Password confirmation doesn't match Password"</span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>if not authenticate, response with <code class="prettyprint">401</code> and following json object,</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Unauthorized"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This api endpoint need Patron authenticated.</p>

<ul>
<li>if success, response with http status code <code class="prettyprint">200</code></li>
<li>if authenticate failed, response with http status code <code class="prettyprint">401</code></li>
<li>if validation failed, for example, passsord mismatch, response with http status code <code class="prettyprint">422</code></li>
</ul>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">PATCH http://phrenzi.com/api/patrons/password</code></p>

<h3 id="url-parameters">URL Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>password</td>
<td>the new password of patron</td>
</tr>
<tr>
<td>password_confirmation</td>
<td>confirm again the new password</td>
</tr>
</tbody></table>

          <h1 id="managers">Managers</h1>

<h2 id="sign-in">Sign In</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/managers/sign_in"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: app_token"</span> <span class="se">\</span>
  -X POST <span class="se">\</span>
  -d <span class="s1">'{
        "email": "abc@gmail.com",
        "password": "password" }'</span>
</code></pre>

<blockquote>
<p>if success, the above command returns <code class="prettyprint">Manager</code> object with <code class="prettyprint">200</code> status code, and structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"manager"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6b586aeb-a53d-476a-9435-659ed9547e6e"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"abc@gmail.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"establishment_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Awesome Bar"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>if failed, the above command returns status code <code class="prettyprint">401</code> and json structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"Invalid login credentials. Please try again."</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>if manager is not confirmed yet, return status code <code class="prettyprint">401</code> and json like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"A confirmation email was sent to your account at 'abc@gmail.com'. You must follow the instructions in the email before your account can be activated"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint try to authenticate Manager, and need App Token authenticated.</p>

<ul>
<li>if success, it will return <code class="prettyprint">Manager</code> object with HTTP Status Code <code class="prettyprint">200</code>, and client can retrive
auth header from reponse to consuming next request that need authentication.</li>
<li>if failed to authenticate, it will return HTTP Status Code <code class="prettyprint">401</code> with <code class="prettyprint">errors</code> message.</li>
</ul>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST http://example.com/api/managers/sign_in</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>email</td>
<td>the email of manager account</td>
</tr>
<tr>
<td>password</td>
<td>the password of manager account</td>
</tr>
</tbody></table>

<h2 id="sign-out">Sign Out</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/managers/sign_out"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"access-token: token"</span> <span class="se">\</span>
  -H <span class="s2">"token-type: Bearer"</span> <span class="se">\</span>
  -H <span class="s2">"client: u4N6u_toFnoDR1o318uOVA"</span> <span class="se">\</span>
  -H <span class="s2">"expiry: 1466692376"</span> <span class="se">\</span>
  -H <span class="s2">"uid: abc@example.com"</span>
  -X DELETE
</code></pre>

<blockquote>
<p>if success, the above command returns status code <code class="prettyprint">200</code>, and json object like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>if failed, the above command returns status code <code class="prettyprint">404</code>, and errors json like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"User was not found or was not logged in."</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>this endpoint need <code class="prettyprint">Auth Header</code> to authenticate manager,
you are going to get it from Manager <code class="prettyprint">Sign In</code> api request
or other subsequence request that need authentication.</p>

<ul>
<li>if success, it will return HTTP Status Code <code class="prettyprint">200</code></li>
<li>if failed to authenticate, it will return HTTP Status Code <code class="prettyprint">404</code> with <code class="prettyprint">errors</code> message.</li>
</ul>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">DELETE http://example.com/api/managers/sign_out</code></p>

          <h1 id="patronapp-profile-image">PatronApp / Profile Image</h1>

<h2 id="pre-sign-url">pre-sign url</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/patron_app/patron_profile/cache/presign"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
   </span><span class="nt">"url"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"https://phrenzistaging.s3-ap-southeast-1.amazonaws.com"</span><span class="p">,</span><span class="w">
   </span><span class="nt">"fields"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"policy"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"eyJleHBpcmF0aW9uIjoiMjAxNi0xMi0wOVQxMDoyNzozMVoiLCJjb25kaXRpb25zIjpbeyJidWNrZXQiOiJwaHJlbnppc3RhZ2luZyJ9LHsia2V5IjoiY2FjaGUvMmE3OGI3MWI2MGYwMmZjMDk3YzFhYWM1ZTA0MDkxMzgifSx7IngtYW16LWNyZWRlbnRpYWwiOiJBS0lBSlhNM1U3QU02STNPRTM2QS8yMDE2MTIwOS9hcC1zb3V0aGVhc3QtMS9zMy9hd3M0X3JlcXVlc3QifSx7IngtYW16LWFsZ29yaXRobSI6IkFXUzQtSE1BQy1TSEEyNTYifSx7IngtYW16LWRhdGUiOiIyMDE2MTIwOVQwOTI3MzFaIn1dfQ=="</span><span class="p">,</span><span class="w">
      </span><span class="nt">"x-amz-algorithm"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"AWS4-HMAC-SHA256"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"key"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"cache/2a78b71b60f02fc097c1aac5e0409138"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"x-amz-signature"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"52956151623087d2a4997462c90055d61e51de3b1a5b8d89f826f1769da3894f"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"x-amz-date"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"20161209T092731Z"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"x-amz-credential"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"AKIAJXM3U7AM6I3OE36A/20161209/ap-southeast-1/s3/aws4_request"</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint retrieves pre-sign url for upload image into s3</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://example.com/api/patron_app/patron_profiile/cache/presign</code></p>

<p>After you retrive the presign url, you could be able to make a post request to presign url with the fields this end-point provided. Then you could be able to retrieve an id from S3. Please construct a json object with this id, and this object will going to be used in next API call to create the actual profile image in Phrenzi</p>

<p>For more detail, please visit shrine&rsquo;s plugin <a href="http://shrinerb.com/rdoc/files/doc/direct_s3_md.html">direct_upload</a></p>

<h2 id="create-patron-profile">create patron profile</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/patron_app/profile"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Authorization: app_token"</span> <span class="se">\</span>
  -X POST <span class="se">\</span>
  -d <span class="s1">'{
        "profile": '</span><span class="o">{</span>
          <span class="s2">"id"</span>: <span class="s2">"349234854924394"</span>, <span class="c"># required</span>
          <span class="s2">"storage"</span>: <span class="s2">"cache"</span>, <span class="c"># required</span>
          <span class="s2">"metadata"</span>: <span class="o">{</span>
            <span class="s2">"size"</span>: 45461, <span class="c"># optional</span>
            <span class="s2">"filename"</span>: <span class="s2">"foo.jpg"</span>, <span class="c"># optional</span>
            <span class="s2">"mime_type"</span>: <span class="s2">"image/jpeg"</span>, <span class="c"># optional</span>
          <span class="o">}</span>
        <span class="o">}</span><span class="s1">'
      }'</span>
</code></pre>

<blockquote>
<p>The above command returns status code 200</p>
</blockquote>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST http://example.com/api/patron_app/profile</code></p>

<h3 id="url-parameters">URL Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>profile</td>
<td>String, json object string demonstrated above</td>
</tr>
</tbody></table>

<p>NOTED: id &amp; storage is required in json object string</p>

<p>For full scenario of upload profile with pre-sign, please refer
<a href="https://github.com/Phrenzi/phrenzi_web/blob/master/spec/requests/api/v1/patron_app/patron_profile_spec.rb">here</a></p>

          <h1 id="patronapp-establishments">PatronApp / Establishments</h1>

<h2 id="get-all-establishments">get all establishments</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/patron_app/establishments"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"establishments"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c3d12f1a-1f0e-4ade-ae6a-49660db2b2ea"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Establishment1"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"phone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"612345671"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"cash_back"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.5"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"desc"</span><span class="p">:</span><span class="w"> </span><span class="s2">"This is an example description"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"logo_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://abc.com/uploads/establishment/logo/c3d12f1a-1f0e-4ade-ae6a-49660db2b2ea/thumb_image.jpeg"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"banner_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://abc.com/uploads/establishment/banner/c3d12f1a-1f0e-4ade-ae6a-49660db2b2ea/thumb_image.jpeg"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"active_booster_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
      </span><span class="nt">"credit_balance"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20000.0"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0c9d3e1c-9499-472c-8f87-9acd0f8866d2"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Establishment2"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"phone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"612345672"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"cash_back"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.5"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"desc"</span><span class="p">:</span><span class="w"> </span><span class="s2">"This is an example description"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"logo_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://abc.com/uploads/establishment/logo/0c9d3e1c-9499-472c-8f87-9acd0f8866d2/thumb_image.jpeg"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"banner_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://abc.com/uploads/establishment/banner/0c9d3e1c-9499-472c-8f87-9acd0f8866d2/thumb_image.jpeg"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"active_booster_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="nt">"credit_balance"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200.0"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint retrieves all establishments</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://example.com/api/patron_app/establishments</code></p>

<aside class="warning">We will add pagination parameter later, but for this phase, we just skip it.</aside>

<h2 id="get-establishment">get establishment</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/patron_app/establishments/c3d12f1a-1f0e-4ade-ae6a-49660db2b2ea"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"establishment"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"610ce5ee-8ce2-4ad2-9296-3e2bd6ec539a"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Establishment1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"phone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"612345671"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"cash_back"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.5"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"desc"</span><span class="p">:</span><span class="w"> </span><span class="s2">"This is an example description"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"logo_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://abc.com/uploads/establishment/logo/e1c3c3b9e1bb587672ed14663c233d2a.jpeg"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"banner_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://abc.com/uploads/establishment/banner/cf2731b3f037e081fee8230378290b62.jpeg"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"active_booster_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
    </span><span class="nt">"credit_balance"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20000.0"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"address"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"54f27047-8a98-4304-b7bc-43b2f855a582"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"street1"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MyString"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"street2"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MyString"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"city"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MyString"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"country"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MyString"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nt">"business_hours"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"wday"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nt">"open_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">39600</span><span class="p">,</span><span class="w">
        </span><span class="nt">"close_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">86400</span><span class="p">,</span><span class="w">
        </span><span class="nt">"closed"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"wday"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"open_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">39600</span><span class="p">,</span><span class="w">
        </span><span class="nt">"close_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">86400</span><span class="p">,</span><span class="w">
        </span><span class="nt">"closed"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"wday"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="nt">"open_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">39600</span><span class="p">,</span><span class="w">
        </span><span class="nt">"close_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">86400</span><span class="p">,</span><span class="w">
        </span><span class="nt">"closed"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"wday"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
        </span><span class="nt">"open_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">39600</span><span class="p">,</span><span class="w">
        </span><span class="nt">"close_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">86400</span><span class="p">,</span><span class="w">
        </span><span class="nt">"closed"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"wday"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
        </span><span class="nt">"open_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">39600</span><span class="p">,</span><span class="w">
        </span><span class="nt">"close_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">86400</span><span class="p">,</span><span class="w">
        </span><span class="nt">"closed"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"wday"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
        </span><span class="nt">"open_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">39600</span><span class="p">,</span><span class="w">
        </span><span class="nt">"close_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">86400</span><span class="p">,</span><span class="w">
        </span><span class="nt">"closed"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"wday"</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w">
        </span><span class="nt">"open_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">39600</span><span class="p">,</span><span class="w">
        </span><span class="nt">"close_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">86400</span><span class="p">,</span><span class="w">
        </span><span class="nt">"closed"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nt">"current_challenge"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"start_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-12-06T16:00:00.000Z"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"end_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-12-06T16:00:00.000Z"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"winner_percentage"</span><span class="p">:</span><span class="w"> </span><span class="s2">"25.0"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"prize_percentage"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5.0"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"total_sales"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10000.0"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"ranking"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"f9128d9c-a60c-471d-8e22-761bc0a0a785"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Patron2"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"join_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-12-07T12:30:01.496Z"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"point_balance"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20.0"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"ranking"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nt">"prize"</span><span class="p">:</span><span class="w"> </span><span class="s2">"500"</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8d7c84fd-c6d1-4c02-b7b6-e5a3d6eebacd"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Patron1"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"join_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-12-07T12:30:01.469Z"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"point_balance"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.0"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"ranking"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"prize"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint retrieves establishment detail</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://example.com/api/patron_app/establishments/c3d12f1a-1f0e-4ade-ae6a-49660db2b2ea</code></p>

          <h1 id="patronapp-transactions">PatronApp / Transactions</h1>

<h2 id="get-all-transactions-by-establishment_id">get all transactions by establishment_id</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/patron_app/transactions"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"access-token: token"</span> <span class="se">\</span>
  -H <span class="s2">"token-type: Bearer"</span> <span class="se">\</span>
  -H <span class="s2">"client: u4N6u_toFnoDR1o318uOVA"</span> <span class="se">\</span>
  -H <span class="s2">"expiry: 1466692376"</span> <span class="se">\</span>
  -H <span class="s2">"uid: abc@example.com"</span> <span class="se">\</span>
  -d <span class="s1">'{
    "establishment_id": "d51dd6c5-ad0e-445f-b3c5-06ab8ec8624b"
    }'</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"transactions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3e2d1786-3379-4311-93c4-86ac85cb6fc3"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"patron_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cd4820df-0572-4e06-a60b-2411fd450272"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"establishment_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"d51dd6c5-ad0e-445f-b3c5-06ab8ec8624b"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"challenge_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trans_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sales"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"sales_amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"applied_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"sales_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.5"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"credit_subtotal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.5"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"remaining_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"cash_back"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.5"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trans_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0cd28c0d26"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"group_code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"tracked_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-29T19:09:43.791+08:00"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"del_transaction_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"deleted_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"deleted"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nt">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Cash Purchase"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c294a412-b391-44c5-8cc7-25a4f4b1a7b5"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"patron_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cd4820df-0572-4e06-a60b-2411fd450272"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"establishment_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"d51dd6c5-ad0e-445f-b3c5-06ab8ec8624b"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"challenge_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trans_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sales"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"sales_amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"applied_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"sales_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.5"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"credit_subtotal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.5"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"remaining_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"cash_back"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.5"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trans_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8c36accb11"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"group_code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"tracked_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-29T19:09:43.791+08:00"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"del_transaction_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"deleted_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"deleted"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nt">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Cash Purchase"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint authenticate by patron authenticate, and retrieves all transactions for specific
patron and for specific establishment</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://example.com/api/patron_app/establishments</code></p>

<aside class="info">This API support pagination. please refer to <a
href="#link-header-result-pagination">Link Header section</a></aside>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>establishment_id</td>
<td>Y</td>
<td>establishment_id that transactions belongs to</td>
</tr>
<tr>
<td>page</td>
<td>N</td>
<td>the page results of all transactions</td>
</tr>
<tr>
<td>per_page</td>
<td>N</td>
<td>the number of transaction record return per page by api, default to be 20</td>
</tr>
</tbody></table>

          <h1 id="patronapp-point-transactions">PatronApp / Point Transactions</h1>

<h2 id="get-all-point-transactions-by-establishment_id">get all point transactions by establishment_id</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/patron_app/point_transactions"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"access-token: token"</span> <span class="se">\</span>
  -H <span class="s2">"token-type: Bearer"</span> <span class="se">\</span>
  -H <span class="s2">"client: u4N6u_toFnoDR1o318uOVA"</span> <span class="se">\</span>
  -H <span class="s2">"expiry: 1466692376"</span> <span class="se">\</span>
  -H <span class="s2">"uid: abc@example.com"</span> <span class="se">\</span>
  -d <span class="s1">'{
    "establishment_id": "d51dd6c5-ad0e-445f-b3c5-06ab8ec8624b"
    }'</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"transactions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"86649ff8-abb4-4e4f-9a64-16607ccac2f4"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"patron_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"437d5272-e694-41cb-8c4f-12c0f37f3588"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"booster_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"challenge_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4972f2df-d378-4f87-b9c9-ac45ab12d0ac"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"point"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9.99"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"point_balance"</span><span class="p">:</span><span class="w"> </span><span class="s2">"19.99"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trans_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"394548216b"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Purchase Points"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"correction"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nt">"tracked_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-05-12T03:02:32.200Z"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9bea46d0-d077-4d0b-beaa-5b11151601d4"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"patron_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"437d5272-e694-41cb-8c4f-12c0f37f3588"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"booster_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"challenge_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4972f2df-d378-4f87-b9c9-ac45ab12d0ac"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"point"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9.99"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"point_balance"</span><span class="p">:</span><span class="w"> </span><span class="s2">"19.99"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trans_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a3ace99530"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Purchase Points"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"correction"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nt">"tracked_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-05-12T03:02:31.200Z"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint authenticate by patron authenticate, and retrieves all transactions for specific patron and for specific establishment</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://example.com/api/patron_app/point_transactions</code></p>

<aside class="info">This API support pagination. please refer to <a
href="#link-header-result-pagination">Link Header section</a></aside>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>establishment_id</td>
<td>Y</td>
<td>establishment_id that transactions belongs to</td>
</tr>
<tr>
<td>page</td>
<td>N</td>
<td>the page results of all transactions</td>
</tr>
<tr>
<td>per_page</td>
<td>N</td>
<td>the number of transaction record return per page by api, default to be 20</td>
</tr>
</tbody></table>

          <h1 id="patronapp-patron-summary">PatronApp / Patron Summary</h1>

<h2 id="get-patron-summary-for-specify-establishment_id">get patron summary for specify establishment_id</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/patron_app/establishments/d51dd6c5-ad0e-445f-b3c5-06ab8ec8624b/summary"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"access-token: token"</span> <span class="se">\</span>
  -H <span class="s2">"token-type: Bearer"</span> <span class="se">\</span>
  -H <span class="s2">"client: u4N6u_toFnoDR1o318uOVA"</span> <span class="se">\</span>
  -H <span class="s2">"expiry: 1466692376"</span> <span class="se">\</span>
  -H <span class="s2">"uid: abc@example.com"</span> <span class="se">\</span>
  -d <span class="s1">'{
    "establishment_id": "d51dd6c5-ad0e-445f-b3c5-06ab8ec8624b"
    }'</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"summary"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"challenge_played"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w">
    </span><span class="nt">"challenge_won"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
    </span><span class="nt">"booster_earned"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="nt">"point_earned"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100.0"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"prize_earned"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100.0"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"cash_back_earned"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.0"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint authenticate by patron authenticate, and retrieves summary statistic data for current authenticated patron and for establishment specified</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://example.com/api/patron_app/establishments/:establishment_id/summary</code></p>

          <h1 id="patronapp-boosters">PatronApp / Boosters</h1>

<h2 id="get-all-boosters-today">get all boosters today</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/patron_app/establishments/c3d12f1a-1f0e-4ade-ae6a-49660db2b2ea/boosters"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"boosters"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"74728c5c-bbc1-4212-91e4-037c25eef234"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"booster_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"check_in"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"actived"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"start_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-22T05:55:39.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"point"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"finished_by"</span><span class="p">:</span><span class="w"> </span><span class="s2">"end_time"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"end_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-22T06:03:59.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"patron"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"redeemed"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9ecedaf3-9b39-4199-9b8f-b050c144b98d"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"booster_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"check_in"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"finished"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"start_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-22T05:57:19.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"point"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"finished_by"</span><span class="p">:</span><span class="w"> </span><span class="s2">"quantity"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"quantity"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"redeem_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nt">"patron"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"redeemed"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="nt">"check_in_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-22T04:03:12.000Z"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"f69285c8-0556-4a26-9c53-f0ca8c9e516f"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"booster_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"target_amount"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"start_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-22T05:58:59.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"end_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-22T05:59:49.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"finished"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"point"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"target_amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"patron"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"redeemed"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6c17a61e-c786-4801-aa5c-2965a94b1585"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"booster_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"target_amount"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"start_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-22T06:02:15.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"end_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-22T06:03:05.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"finished"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"point"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"target_amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"patron"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"redeemed"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="nt">"number_of_transaction"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"total_accumulated_sales"</span><span class="p">:</span><span class="w"> </span><span class="s2">"50.0"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"not_rewarded_sales"</span><span class="p">:</span><span class="w"> </span><span class="s2">"50.0"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"accumulated_redeemed_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bf15f7c5-ddee-404f-9966-c9feaea36b53"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"booster_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"target_amount"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"start_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-22T06:03:12.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"end_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-22T06:04:02.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"finished"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"point"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"target_amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"patron"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"redeemed"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="nt">"number_of_transaction"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="nt">"total_accumulated_sales"</span><span class="p">:</span><span class="w"> </span><span class="s2">"150.0"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"not_rewarded_sales"</span><span class="p">:</span><span class="w"> </span><span class="s2">"50.0"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"accumulated_redeemed_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"981a00e6-9dcf-4af0-91a5-74f3f2a81882"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"booster_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invitation"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"start_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-22T05:59:49.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"actived"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"end_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-22T06:00:49.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"host_point"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"invitee_point"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"unlimited"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nt">"patron"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"redeemed"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="nt">"host_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"80284ba8-9e0e-447a-bdb7-5ef6b2187c99"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"booster_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invitation"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"start_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-22T05:59:59.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"finished"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"end_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-22T06:00:34.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"host_point"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"invitee_point"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"unlimited"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nt">"invitation_limit"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
      </span><span class="nt">"patron"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"redeemed"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="nt">"host_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"aba9872b-6831-4e7e-ba8e-75b711344ba8"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"booster_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invitation"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"start_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-23T09:56:53.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"actived"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"end_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-23T09:57:53.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"host_point"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"invitee_point"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"unlimited"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nt">"patron"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"redeemed"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
        </span><span class="nt">"check_in_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-23T17:57:43.605+08:00"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"invitation_sent_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="nt">"invited_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nt">"total_claimed_point"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"35a81e59-55eb-4f28-8b2f-7f117f06f938"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"booster_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invitation"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"start_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-23T09:58:43.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"actived"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"end_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-23T09:59:43.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"host_point"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"invitee_point"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"unlimited"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nt">"patron"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nt">"redeemed"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="nt">"check_in_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-23T17:59:33.185+08:00"</span><span class="p">,</span><span class="w">
        </span><span class="nt">"invitation_sent_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="nt">"invited_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nt">"total_claimed_point"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100.0"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint retrieves all boosters, along with booster information connected with current patron</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://example.com/api/patron_app/establishments/:establishment_id/boosters</code></p>

<aside class="warning">We will add pagination parameter later, but for this phase, we just skip it.</aside>

          <h1 id="patronapp-check-in">PatronApp / Check In</h1>

<h2 id="patron-check-in">patron check in</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/patron_app/establishments/c3d12f1a-1f0e-4ade-ae6a-49660db2b2ea/check_in"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"access-token: token"</span> <span class="se">\</span>
  -H <span class="s2">"token-type: Bearer"</span> <span class="se">\</span>
  -H <span class="s2">"client: u4N6u_toFnoDR1o318uOVA"</span> <span class="se">\</span>
  -H <span class="s2">"expiry: 1466692376"</span> <span class="se">\</span>
  -H <span class="s2">"uid: abc@example.com"</span> <span class="se">\</span>
  -X POST <span class="se">\</span>
  -d <span class="s1">'{
    "lat": "23.2333",
    "long": "-22.1234"
    }'</span>
</code></pre>

<blockquote>
<p>The above command returns status code 200 with response of JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"boosters"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"202f96fb-1536-43fa-a6ba-7b0387e90465"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"check_in"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"failed"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"error_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"REDEEMED_ALREADY"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"40be79a4-92b3-447a-aff2-0ab5f9210aca"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"check_in"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"failed"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"error_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"REACH_REDEEM_COUNT"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c3c7fdf5-8629-4c13-9b86-b911ab86adce"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"check_in"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"failed"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"error_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EXPIRED"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"39c42912-91cf-48dd-abbf-a273da146568"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"check_in"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"success"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"point"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100.0"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"39c42912-91cf-48dd-abbf-b911ab86adce"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invitation"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"success"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"point"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c3c7fdf5-91cf-48dd-abbf-b911ab86adce"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invitation"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"success"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"point"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200.0"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c3c7fdf5-91cf-48dd-abbf-b911ab86adce"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"invitation"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"failed"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"error_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"CHECKED_IN"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>If patron&rsquo;s lat &amp; long is closed enough to establishment, return status code 406 and following
JSON response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Current Location is not near enough"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>If patron&rsquo;s lat &amp; long have format error, return status code 422 and following JSON response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">"lat"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"can't be blank"</span><span class="p">],</span><span class="w"> </span><span class="nt">"long"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"can't be blank"</span><span class="p">]</span><span class="w"> </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>If current there&rsquo;s no challenge today, return status code 406 and following JSON response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"There is no active Challenge today"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint check in current logined patron into Establishment specify</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST http://example.com/api/patron_app/establishments/:establishment_id/check_in</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<p>NOTED: establishment_id is the uuid of establishment</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>lat</td>
<td>Y</td>
<td>latitude of patron&rsquo;s location, example &lsquo;23.233&rsquo;</td>
</tr>
<tr>
<td>long</td>
<td>Y</td>
<td>longitude of patron&rsquo;s location, example: &rsquo;-23.233&rsquo;</td>
</tr>
</tbody></table>

          <h1 id="patronapp-invitation">PatronApp / Invitation</h1>

<h2 id="invite-patron">Invite Patron</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/patron_app/boosters/c3d12f1a-1f0e-4ade-ae6a-49660db2b2ea/invite"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"access-token: token"</span> <span class="se">\</span>
  -H <span class="s2">"token-type: Bearer"</span> <span class="se">\</span>
  -H <span class="s2">"client: u4N6u_toFnoDR1o318uOVA"</span> <span class="se">\</span>
  -H <span class="s2">"expiry: 1466692376"</span> <span class="se">\</span>
  -H <span class="s2">"uid: abc@example.com"</span> <span class="se">\</span>
  -X POST <span class="se">\</span>
  -d <span class="s1">'{
    "invitee_patron_id": "202f96fb-1536-43fa-a6ba-7b0387e90465"
    }'</span>
</code></pre>

<blockquote>
<p>if success invited, then returns status code 200 with empty body.</p>

<p>if there&rsquo;s validation error, then return status code 422, and following error JSON
response, with error explaination:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Invitee patron does not exist"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>If current authenticated patron is not checked-in, then he is not allow to invite, in this case, return status code 406 and following
JSON response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Can't invite anyone before your check-in"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>If invitee is already invited, return status code 406 and following JSON response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Invitee have been invited"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>If invitee already checked-in, return status code 406 and following JSON response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Invitee already checked-in"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>If host reach invitation limit, return status code 406 and following JSON response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"You have reached invitation limit, can't invite anymore"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint create a invitation for current logined patron to patron specify</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST http://example.com/api/patron_app/boosters/:booster_id/invite</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<p>NOTED: booster_id is the uuid of booster, and must be a invitation booster</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>invitee_patron_id</td>
<td>Y</td>
<td>invitee&rsquo;s uuid</td>
</tr>
</tbody></table>

<h2 id="cancel-invitation">Cancel Invitation</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/patron_app/boosters/c3d12f1a-1f0e-4ade-ae6a-49660db2b2ea/cancel_invite"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"access-token: token"</span> <span class="se">\</span>
  -H <span class="s2">"token-type: Bearer"</span> <span class="se">\</span>
  -H <span class="s2">"client: u4N6u_toFnoDR1o318uOVA"</span> <span class="se">\</span>
  -H <span class="s2">"expiry: 1466692376"</span> <span class="se">\</span>
  -H <span class="s2">"uid: abc@example.com"</span> <span class="se">\</span>
  -X POST <span class="se">\</span>
  -d <span class="s1">'{
    "invitee_patron_id": "202f96fb-1536-43fa-a6ba-7b0387e90465"
    }'</span>
</code></pre>

<blockquote>
<p>if success, then returns status code 200 with empty body.</p>

<p>if there&rsquo;s validation error, then return status code 422, and following error JSON
response, with error explaination:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Invitee patron does not exist"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>If invitee is not invited, return status code 406 and following JSON response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Invitee is not invited by you"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>If invitee already checked-in, return status code 406 and following JSON response:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Invitee already checked-in"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint cancel a invitation from current logined patron to patron specify</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST http://example.com/api/patron_app/boosters/:booster_id/cancel_invite</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<p>NOTED: booster_id is the uuid of booster, and must be a invitation booster</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>invitee_patron_id</td>
<td>Y</td>
<td>invitee&rsquo;s uuid</td>
</tr>
</tbody></table>

<h2 id="invitation-patron-list">Invitation patron list</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/patron_app/boosters/c3d12f1a-1f0e-4ade-ae6a-49660db2b2ea/patrons"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"access-token: token"</span> <span class="se">\</span>
  -H <span class="s2">"token-type: Bearer"</span> <span class="se">\</span>
  -H <span class="s2">"client: u4N6u_toFnoDR1o318uOVA"</span> <span class="se">\</span>
  -H <span class="s2">"expiry: 1466692376"</span> <span class="se">\</span>
  -H <span class="s2">"uid: abc@example.com"</span> <span class="se">\</span>
</code></pre>

<blockquote>
<p>if success invited, then returns status code 200 with following json:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"patrons"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"644553a9-35ff-4055-b9d5-d53ecc9c8697"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"David"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"aasm_state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"waiting"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ad94291b-1f2b-4e2f-bdb6-8265ce0ed89f"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Kerry"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"aasm_state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"opened"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"709eff27-5942-4530-be8d-de0421e61e5f"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Peter"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"aasm_state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cancelled"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e8a89686-84a8-4e65-9712-4be4223bca25"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Ryan"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"aasm_state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"checked_in"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"db8c75ab-a6e9-47dd-9a51-afc3be2f85c8"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Zee"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"aasm_state"</span><span class="p">:</span><span class="w"> </span><span class="s2">"checked_in"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>if booster specify is invalid / expired, return status code 406 and following json message:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"Booster specify is not active now"</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>if current patron is not checked-in yet, return status code 406 and following json message:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"You have not check in to this booster yet"</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint get a patron list with aasm_state which is related to current login patron.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://example.com/api/patron_app/boosters/:booster_id/patrons</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<p>NOTED: booster_id is the uuid of booster, and must be a invitation booster</p>

<h3 id="patron-response">Patron Response</h3>

<p>returned patron response along with aasm_state, here&rsquo;s a summary of possible values and related description</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Value</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>aasm_state</td>
<td>&lsquo;opened&rsquo;</td>
<td>patron is not invited by current patron, one can call invite api to invite that patron</td>
</tr>
<tr>
<td>aasm_state</td>
<td>&#39;waiting&rsquo;</td>
<td>patron is invited by current patron, can not invite anymore</td>
</tr>
<tr>
<td>aasm_state</td>
<td>&#39;cancelled&rsquo;</td>
<td>invitation to that patron is cancelled by current patron in earlier time, one can call invite api to invite that patron again</td>
</tr>
<tr>
<td>aasm_state</td>
<td>&#39;checked_in&rsquo;</td>
<td>that patron is already checked-in, either invited by current patron or invited by other patrons, can not invite anymore</td>
</tr>
</tbody></table>

<h2 id="inviation-host-list">Inviation Host list</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/patron_app/boosters/c3d12f1a-1f0e-4ade-ae6a-49660db2b2ea/my_hosts"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"access-token: token"</span> <span class="se">\</span>
  -H <span class="s2">"token-type: Bearer"</span> <span class="se">\</span>
  -H <span class="s2">"client: u4N6u_toFnoDR1o318uOVA"</span> <span class="se">\</span>
  -H <span class="s2">"expiry: 1466692376"</span> <span class="se">\</span>
  -H <span class="s2">"uid: abc@example.com"</span> <span class="se">\</span>
</code></pre>

<blockquote>
<p>if success invited, then returns status code 200 with following json:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"patrons"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"f0dab179-de3b-486a-87bd-35643242350f"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"David"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"d7bb37d4-873b-4b5d-81eb-46bb023a465e"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Ryan"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>if current login patron is already checked-in ( as a host ), then returns status code 406 with
following json message:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"You have been check in"</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>if booster specify is invalid / expired, return status code 406 and following json message:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"Booster specify is not active now"</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint get a host list for current login patron regarding on invitation booster specify</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://example.com/api/patron_app/boosters/:booster_id/my_hosts</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<p>NOTED: <code class="prettyprint">booster_id</code> is the uuid of booster, and must be a invitation booster</p>

          <h1 id="patronapp-notification">PatronApp / Notification</h1>

<h2 id="notification-list">Notification List</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/patron_app/notification_subscriptions"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"access-token: token"</span> <span class="se">\</span>
  -H <span class="s2">"token-type: Bearer"</span> <span class="se">\</span>
  -H <span class="s2">"client: u4N6u_toFnoDR1o318uOVA"</span> <span class="se">\</span>
  -H <span class="s2">"expiry: 1466692376"</span> <span class="se">\</span>
  -H <span class="s2">"uid: abc@example.com"</span>
</code></pre>

<blockquote>
<p>if success then returns status code 200 with subscriptions detail objects.</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"subscriptions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"device_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"b62efad0-5ae8-42c7-b11b-860ae3078952"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"os_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ios"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"subscribed_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-04-13T10:02:49.575Z"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"device_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"38cbc5fe-d051-4015-b8dc-7857334c61b5"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"os_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"android"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"subscribed_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-04-13T10:04:29.575Z"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint return all subscriptions record for current patron</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://example.com/api/patron_app/notification_subscriptions</code></p>

<h2 id="subscribe-notification">Subscribe Notification</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/patron_app/notification_subscriptions"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"access-token: token"</span> <span class="se">\</span>
  -H <span class="s2">"token-type: Bearer"</span> <span class="se">\</span>
  -H <span class="s2">"client: u4N6u_toFnoDR1o318uOVA"</span> <span class="se">\</span>
  -H <span class="s2">"expiry: 1466692376"</span> <span class="se">\</span>
  -H <span class="s2">"uid: abc@example.com"</span> <span class="se">\</span>
  -X POST <span class="se">\</span>
  -d <span class="s1">'{
    "device_token": "202f96fb-1536-43fa-a6ba-7b0387e90465",
    "os_type": '</span>ios<span class="s1">'
    }'</span>
</code></pre>

<blockquote>
<p>if success subscribed, then returns status code 200 with empty body.</p>

<p>if there&rsquo;s validation error, then return status code 422, and following error JSON
response, with error explaination:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Os type is not included in the list"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>If current patron is subscribed already, still return status code 200 with empty body.</p>
</blockquote>

<p>This endpoint subscribe current patron to notification pool</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST http://example.com/api/patron_app/notification_subscriptions</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>device_token</td>
<td>Y</td>
<td>iOS&rsquo;s device token</td>
</tr>
<tr>
<td>os_type</td>
<td>Y</td>
<td>Os type, available value are: &lsquo;ios&rsquo;, &#39;android&rsquo;</td>
</tr>
</tbody></table>

<h2 id="unsubscribe-notification">Unsubscribe Notification</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/patron_app/notification_subscriptions"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"access-token: token"</span> <span class="se">\</span>
  -H <span class="s2">"token-type: Bearer"</span> <span class="se">\</span>
  -H <span class="s2">"client: u4N6u_toFnoDR1o318uOVA"</span> <span class="se">\</span>
  -H <span class="s2">"expiry: 1466692376"</span> <span class="se">\</span>
  -H <span class="s2">"uid: abc@example.com"</span> <span class="se">\</span>
  -X DELETE <span class="se">\</span>
  -d <span class="s1">'{
    "device_token": "202f96fb-1536-43fa-a6ba-7b0387e90465",
    "os_type": '</span>ios<span class="s1">'
    }'</span>
</code></pre>

<blockquote>
<p>if success unsubscribed, then returns status code 200 with empty body.</p>

<p>if there&rsquo;s validation error, then return status code 422, and following error JSON
response, with error explaination:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Os type is not included in the list"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>If current patron not subscribed before, still return status code 200 with empty body.</p>
</blockquote>

<p>This endpoint unsubscribe current patron from notification pool</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">DELETE http://example.com/api/patron_app/notification_subscriptions</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>device_token</td>
<td>Y</td>
<td>iOS&rsquo;s device token</td>
</tr>
<tr>
<td>os_type</td>
<td>Y</td>
<td>Os type, available value are: &#39;ios&rsquo;, &#39;android&rsquo;</td>
</tr>
</tbody></table>

          <h1 id="management-patrons">Management / Patrons</h1>

<h2 id="get-all-patrons">Get all patrons</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/management/patrons"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"access-token: token"</span> <span class="se">\</span>
  -H <span class="s2">"token-type: Bearer"</span> <span class="se">\</span>
  -H <span class="s2">"client: u4N6u_toFnoDR1o318uOVA"</span> <span class="se">\</span>
  -H <span class="s2">"expiry: 1466692376"</span> <span class="se">\</span>
  -H <span class="s2">"uid: abc@example.com"</span> <span class="se">\</span>
</code></pre>

<blockquote>
<p>The above command returns array of <code class="prettyprint">Patron</code> object like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"patrons"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"8d3d7ecd-585d-4f2f-ad21-1b457e062681"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Patron1"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"patron1@gmail.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"credit_balance"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100.23"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trans_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"52553b"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fcbdd18f-e5ea-4368-8cf4-2e688e604a40"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Patron2"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"patron2@gmail.com"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"credit_balance"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trans_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"25e8ac"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint require manager authentication, and retrieves all patrons.</p>

<p>Noted that credit_balance returned from patron object is for manager&rsquo;s establishment,
the <code class="prettyprint">credit_balance</code> return from different manager authenticated should be differernt.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://phrenzi.com/api/management/patrons</code></p>

<aside class="info">This API support pagination. please refer to <a
href="#link-header-result-pagination">Link Header section</a></aside>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>page</td>
<td>N</td>
<td>the page results of all transactions</td>
</tr>
<tr>
<td>per_page</td>
<td>N</td>
<td>the number of transaction record return per page by api, default to be 20</td>
</tr>
</tbody></table>

<h2 id="get-patron">Get patron</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/management/patrons/ddbd0c3c-404d-4ce1-9042-9baecb4ef585"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"access-token: token"</span> <span class="se">\</span>
  -H <span class="s2">"token-type: Bearer"</span> <span class="se">\</span>
  -H <span class="s2">"client: u4N6u_toFnoDR1o318uOVA"</span> <span class="se">\</span>
  -H <span class="s2">"expiry: 1466692376"</span> <span class="se">\</span>
  -H <span class="s2">"uid: abc@example.com"</span> <span class="se">\</span>
</code></pre>

<blockquote>
<p>The above command return <code class="prettyprint">Patron</code> object like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"patron"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ddbd0c3c-404d-4ce1-9042-9baecb4ef585"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Patron1"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"patron1@gmail.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"credit_balance"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100.23"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"trans_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"519665"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint require manager authentication, and retrieves patron object.</p>

<p>Noted that credit_balance returned from patron object is for manager&rsquo;s establishment,
the <code class="prettyprint">credit_balance</code> return from different manager authenticated should be differernt.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://phrenzi.com/api/management/patrons/ddbd0c3c-404d-4ce1-9042-9baecb4ef585</code></p>

          <h1 id="management-transactions">Management / Transactions</h1>

<h2 id="get-all-transactions-by-patron_id-for-current-establishment">Get all transactions by patron_id for current establishment</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/management/transactions"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"access-token: token"</span> <span class="se">\</span>
  -H <span class="s2">"token-type: Bearer"</span> <span class="se">\</span>
  -H <span class="s2">"client: u4N6u_toFnoDR1o318uOVA"</span> <span class="se">\</span>
  -H <span class="s2">"expiry: 1466692376"</span> <span class="se">\</span>
  -H <span class="s2">"uid: abc@example.com"</span> <span class="se">\</span>
  -d <span class="s1">'{
    "patron_id": "a9ce92dd-1b1d-498a-b7d0-77fffccd20de"
    }'</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"transactions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"15477325-11fa-4b85-87a9-30f6272656be"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"patron_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a9ce92dd-1b1d-498a-b7d0-77fffccd20de"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"establishment_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"277e92b3-3332-4ccc-92e3-c17eb6e7c507"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"challenge_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trans_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sales"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"sales_amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"applied_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"sales_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.5"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"credit_subtotal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.5"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"remaining_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"cash_back"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.5"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trans_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9a47366866"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"group_code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"tracked_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-29T19:04:28.067+08:00"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"del_transaction_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"deleted_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"deleted"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nt">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Cash Purchase"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0db22eca-326f-4b8c-b5bc-c517256cc64c"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"patron_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a9ce92dd-1b1d-498a-b7d0-77fffccd20de"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"establishment_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"277e92b3-3332-4ccc-92e3-c17eb6e7c507"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"challenge_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trans_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sales"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"sales_amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"100.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"applied_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"sales_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.5"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"credit_subtotal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.5"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"remaining_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"cash_back"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.5"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trans_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"613ef86f6b"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"group_code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"tracked_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-29T19:04:28.067+08:00"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"del_transaction_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"deleted_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"deleted"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nt">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Cash Purchase"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint need manager authentication, and retrieves transaction records by establishment by patron</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://example.com/api/management/transactions</code></p>

<aside class="info">This API support pagination. please refer to <a
href="#link-header-result-pagination">Link Header section</a></aside>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Requred?</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>patron_id</td>
<td>Y</td>
<td>only list transactions that belongs to patron</td>
</tr>
<tr>
<td>page</td>
<td>N</td>
<td>the page results of all transactions, default to be page 1</td>
</tr>
<tr>
<td>per_page</td>
<td>N</td>
<td>the number of transaction record return per page by api, default to be 20</td>
</tr>
</tbody></table>

<h2 id="create-transaction">Create Transaction</h2>

<blockquote>
<p>For creating fullay sales transaction</p>
</blockquote>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/management/transactions"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"access-token: token"</span> <span class="se">\</span>
  -H <span class="s2">"token-type: Bearer"</span> <span class="se">\</span>
  -H <span class="s2">"client: u4N6u_toFnoDR1o318uOVA"</span> <span class="se">\</span>
  -H <span class="s2">"expiry: 1466692376"</span> <span class="se">\</span>
  -H <span class="s2">"uid: abc@example.com"</span> <span class="se">\</span>
  -X POST <span class="se">\</span>
  -d <span class="s1">'{
    "trans_type": "sale",
    "patron_id": "ddbd0c3c-404d-4ce1-9042-9baecb4ef585",
    "sales_amount": 200.00,
    "credit_amount": 0.0
    }'</span>
</code></pre>

<blockquote>
<p>The above command returns HTML status code 200 OK if success and json object</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"transactions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1f485151-80ad-4d25-88bd-89e343b1e7f6"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"patron_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ddbd0c3c-404d-4ce1-9042-9baecb4ef585"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"establishment_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3da90d84-92db-487f-af45-e020fbcaf0bd"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"challenge_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trans_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sales"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"sales_amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"applied_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"sales_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"credit_subtotal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"remaining_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"cash_back"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.5"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trans_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9914f6658f"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"group_code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"tracked_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-29T18:33:58.327+08:00"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"del_transaction_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"deleted_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"deleted"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nt">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Cash Purchase"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>For creating partially sales transaction</p>
</blockquote>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/management/transactions"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"access-token: token"</span> <span class="se">\</span>
  -H <span class="s2">"token-type: Bearer"</span> <span class="se">\</span>
  -H <span class="s2">"client: u4N6u_toFnoDR1o318uOVA"</span> <span class="se">\</span>
  -H <span class="s2">"expiry: 1466692376"</span> <span class="se">\</span>
  -H <span class="s2">"uid: abc@example.com"</span> <span class="se">\</span>
  -X POST <span class="se">\</span>
  -d <span class="s1">'{
    "trans_type": "sale",
    "patron_id": "3afc8c7e-ea86-4b85-abb6-1a3616a80f6b",
    "sales_amount": 200.00,
    "credit_amount": -125.0
    }'</span>
</code></pre>

<blockquote>
<p>The above command returns HTML status code 200 OK if success and json object</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"transactions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1f1ba450-4e4c-4570-bf4f-26cf6664566b"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"patron_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3afc8c7e-ea86-4b85-abb6-1a3616a80f6b"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"establishment_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1ac3affe-540b-4fde-8dee-eb6ac5f38376"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"challenge_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trans_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sales"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"sales_amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"75.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"applied_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"sales_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2.6"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"credit_subtotal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2.6"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"remaining_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"202.6"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"cash_back"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.5"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trans_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2fdbce4d14"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"group_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dc8225e705"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"tracked_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-29T18:36:04.640+08:00"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"del_transaction_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"deleted_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"deleted"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nt">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Cash Purchase"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"441a3707-3015-4bb7-9df9-0d2fae3a4db1"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"patron_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3afc8c7e-ea86-4b85-abb6-1a3616a80f6b"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"establishment_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1ac3affe-540b-4fde-8dee-eb6ac5f38376"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"challenge_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trans_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"credit"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"sales_amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"125.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"applied_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-125.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"sales_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"credit_subtotal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-120.6"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"remaining_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"77.6"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"cash_back"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.5"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trans_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4042580c33"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"group_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dc8225e705"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"tracked_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-29T18:36:04.640+08:00"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"del_transaction_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"deleted_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"deleted"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nt">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Credit Purchase"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>For creating fully credit redeem transaction</p>
</blockquote>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/management/transactions"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"access-token: token"</span> <span class="se">\</span>
  -H <span class="s2">"token-type: Bearer"</span> <span class="se">\</span>
  -H <span class="s2">"client: u4N6u_toFnoDR1o318uOVA"</span> <span class="se">\</span>
  -H <span class="s2">"expiry: 1466692376"</span> <span class="se">\</span>
  -H <span class="s2">"uid: abc@example.com"</span> <span class="se">\</span>
  -X POST <span class="se">\</span>
  -d <span class="s1">'{
    "type": "sale",
    "patron_id": "ddbd0c3c-404d-4ce1-9042-9baecb4ef585",
    "sales_amount": 200.00,
    "credit_amount": -200.0
    }'</span>
</code></pre>

<blockquote>
<p>The above command returns HTML status code 200 OK if success and json object</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"transactions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4f27f679-af58-4046-8b96-49f53148f8b4"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"patron_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ddbd0c3c-404d-4ce1-9042-9baecb4ef585"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"establishment_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"95884702-f53a-4bec-891b-ec9b0bbb5acb"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"challenge_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trans_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"credit"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"sales_amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"applied_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-200.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"sales_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"credit_subtotal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-200.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"remaining_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"cash_back"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.5"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trans_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"f1b1ef0e7b"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"group_code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"tracked_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-29T18:39:44.563+08:00"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"del_transaction_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"deleted_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"deleted"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nt">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Credit Purchase"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>For creating correction credit transaction</p>
</blockquote>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/management/transactions"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"access-token: token"</span> <span class="se">\</span>
  -H <span class="s2">"token-type: Bearer"</span> <span class="se">\</span>
  -H <span class="s2">"client: u4N6u_toFnoDR1o318uOVA"</span> <span class="se">\</span>
  -H <span class="s2">"expiry: 1466692376"</span> <span class="se">\</span>
  -H <span class="s2">"uid: abc@example.com"</span> <span class="se">\</span>
  -X POST <span class="se">\</span>
  -d <span class="s1">'{
    "type": "correction",
    "patron_id": "ddbd0c3c-404d-4ce1-9042-9baecb4ef585",
    "sales_amount": 0.0,
    "credit_amount": -200.0
    }'</span>
</code></pre>

<blockquote>
<p>The above command returns HTML status code 200 OK if success and json object</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"transactions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"b4c6b6c6-7bca-47f9-97ea-e470480a4475"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"patron_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ddbd0c3c-404d-4ce1-9042-9baecb4ef585"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"establishment_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"f9a3eed7-b948-4ad9-bf09-b8a54807ccab"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"challenge_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trans_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"correction"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"sales_amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"applied_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"sales_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"credit_subtotal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-200.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"remaining_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"cash_back"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trans_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"25aa44f431"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"group_code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"tracked_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-29T18:40:32.878+08:00"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"del_transaction_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"deleted_at"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"deleted"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nt">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Credit Correction"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Error Scenarios</p>
</blockquote>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/management/transactions"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"access-token: token"</span> <span class="se">\</span>
  -H <span class="s2">"token-type: Bearer"</span> <span class="se">\</span>
  -H <span class="s2">"client: u4N6u_toFnoDR1o318uOVA"</span> <span class="se">\</span>
  -H <span class="s2">"expiry: 1466692376"</span> <span class="se">\</span>
  -H <span class="s2">"uid: abc@example.com"</span> <span class="se">\</span>
  -X POST <span class="se">\</span>
  -d <span class="s1">'{
    "type": "correction",
    "patron_id": "ddbd0c3c-404d-4ce1-9042-9baecb4ef585",
    "sales_amount": 0.0,
    "credit_amount": -200.0
    }'</span>
</code></pre>

<blockquote>
<p>if establishment is not open, the above command returns status code 406, and errors json like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Current Establishment is not opened"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>if current credit balance is not enough, then return status code 406, and errors json like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"Balance not enough"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>if input validation is failed</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"trans_type"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"is not included in the list"</span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint required manager authentication, and create transaction records.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">POST http://example.com/api/management/transactions</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>trans_type</td>
<td>Y</td>
<td>&lsquo;sales&rsquo;/&#39;correction&rsquo;</td>
</tr>
<tr>
<td>sales_amount</td>
<td>Y</td>
<td>the sale amount</td>
</tr>
<tr>
<td>credit_amount</td>
<td>Y</td>
<td>the credit amount</td>
</tr>
<tr>
<td>patron_id</td>
<td>Y</td>
<td>UUID of patron</td>
</tr>
<tr>
<td>cash_back</td>
<td>N</td>
<td>cash back for one time use case</td>
</tr>
<tr>
<td>password</td>
<td>N</td>
<td>if cash_back is present, then password of patron must provided</td>
</tr>
</tbody></table>

<h3 id="query-exmaple">Query Exmaple:</h3>

<p>normal sale record, without credit redeem:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>trans_type</td>
<td>&#39;sale&rsquo;</td>
</tr>
<tr>
<td>patron_id</td>
<td>&ldquo;ddbd0c3c-404d-4ce1-9042-9baecb4ef585&rdquo;</td>
</tr>
<tr>
<td>sales_amount</td>
<td>200.0</td>
</tr>
<tr>
<td>credit_amount</td>
<td>0.0</td>
</tr>
</tbody></table>

<p>sale record, with partially credit redeem ( 200 sale amount, but with 125 credit redeem , so patron just need to pay 75.0 ):</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>trans_type</td>
<td>&#39;sale&rsquo;</td>
</tr>
<tr>
<td>patron_id</td>
<td>&ldquo;ddbd0c3c-404d-4ce1-9042-9baecb4ef585&rdquo;</td>
</tr>
<tr>
<td>sales_amount</td>
<td>200.0</td>
</tr>
<tr>
<td>credit_amount</td>
<td>-125.0</td>
</tr>
</tbody></table>

<p>sale record, fully credit redeem ( 200 sale amount, 200 credit redeem, so patron do not need to pay):</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>trans_type</td>
<td>&#39;sale&rsquo;</td>
</tr>
<tr>
<td>patron_id</td>
<td>&ldquo;ddbd0c3c-404d-4ce1-9042-9baecb4ef585&rdquo;</td>
</tr>
<tr>
<td>sales_amount</td>
<td>200.0</td>
</tr>
<tr>
<td>credit_amount</td>
<td>-200.0</td>
</tr>
</tbody></table>

<p>positive correction record:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>trans_type</td>
<td>&#39;correction&rsquo;</td>
</tr>
<tr>
<td>patron_id</td>
<td>&ldquo;ddbd0c3c-404d-4ce1-9042-9baecb4ef585&rdquo;</td>
</tr>
<tr>
<td>sales_amount</td>
<td>0.0</td>
</tr>
<tr>
<td>credit_amount</td>
<td>125.0</td>
</tr>
</tbody></table>

<p>negative correction record:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>trans_type</td>
<td>&#39;correction&rsquo;</td>
</tr>
<tr>
<td>patron_id</td>
<td>&ldquo;ddbd0c3c-404d-4ce1-9042-9baecb4ef585&rdquo;</td>
</tr>
<tr>
<td>sales_amount</td>
<td>0.0</td>
</tr>
<tr>
<td>credit_amount</td>
<td>-125.0</td>
</tr>
</tbody></table>

<h2 id="delete-transaction">Delete Transaction</h2>

<blockquote>
<p>For delete fullay sales transaction</p>
</blockquote>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/management/transactions/ddbd0c3c-404d-4ce1-9042-9baecb4ef585"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"access-token: token"</span> <span class="se">\</span>
  -H <span class="s2">"token-type: Bearer"</span> <span class="se">\</span>
  -H <span class="s2">"client: u4N6u_toFnoDR1o318uOVA"</span> <span class="se">\</span>
  -H <span class="s2">"expiry: 1466692376"</span> <span class="se">\</span>
  -H <span class="s2">"uid: abc@example.com"</span> <span class="se">\</span>
  -X DELETE
</code></pre>

<blockquote>
<p>The above command returns HTML status code 200 OK if success and json object</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"transactions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"f4ef1c91-105b-4323-b1cb-2642bb7fa870"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"patron_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cce8f71d-5eda-4b74-b3ed-bc5fc46edfe3"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"establishment_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"d9b6a80d-309f-49d5-9714-39b80cef43f9"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"challenge_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trans_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sales"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"sales_amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-100.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"applied_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-0.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"sales_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-3.5"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"credit_subtotal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-3.5"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"remaining_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"196.5"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"cash_back"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.5"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trans_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c57d322c62"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"group_code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"tracked_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-29T18:51:41.470+08:00"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"del_transaction_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ddbd0c3c-404d-4ce1-9042-9baecb4ef585"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"deleted_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-29T18:51:42.470+08:00"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"deleted"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nt">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Cash Purchase Deletion"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>For delete partially sales transaction</p>
</blockquote>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/management/transactions/ddbd0c3c-404d-4ce1-9042-9baecb4ef585"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"access-token: token"</span> <span class="se">\</span>
  -H <span class="s2">"token-type: Bearer"</span> <span class="se">\</span>
  -H <span class="s2">"client: u4N6u_toFnoDR1o318uOVA"</span> <span class="se">\</span>
  -H <span class="s2">"expiry: 1466692376"</span> <span class="se">\</span>
  -H <span class="s2">"uid: abc@example.com"</span> <span class="se">\</span>
  -X DELETE
</code></pre>

<blockquote>
<p>The above command returns HTML status code 200 OK if success and json object</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"transactions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e78701fa-259c-4608-83d8-ef8701841c07"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"patron_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"f0731af3-d5ce-4e75-a689-fdf13c05968f"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"establishment_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5e1f01e1-d489-4d62-98d7-19a4d21345cc"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"challenge_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trans_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sales"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"sales_amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-75.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"applied_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-0.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"sales_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-2.63"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"credit_subtotal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-2.63"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"remaining_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"197.37"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"cash_back"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.5"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trans_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"902c2747aa"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"group_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"abcdefgfhi"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"tracked_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-29T18:53:10.256+08:00"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"del_transaction_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ddbd0c3c-404d-4ce1-9042-9baecb4ef585"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"deleted_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-29T18:53:12.256+08:00"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"deleted"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nt">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Cash Purchase Deletion"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"41c6f8d1-6539-436e-aeef-86d870c7f4c1"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"patron_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"f0731af3-d5ce-4e75-a689-fdf13c05968f"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"establishment_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5e1f01e1-d489-4d62-98d7-19a4d21345cc"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"challenge_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trans_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"credit"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"sales_amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-125.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"applied_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"125.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"sales_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-0.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"credit_subtotal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"125.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"remaining_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"322.37"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"cash_back"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.5"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trans_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5fc5031cc8"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"group_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"abcdefgfhi"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"tracked_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-29T18:53:11.256+08:00"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"del_transaction_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6a2c4670-c588-401a-9f03-a9c8783557be"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"deleted_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-29T18:53:12.256+08:00"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"deleted"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nt">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Credit Purchase Deletion"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>For delete fully credit redeem transaction</p>
</blockquote>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/management/transactions/ddbd0c3c-404d-4ce1-9042-9baecb4ef585"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"access-token: token"</span> <span class="se">\</span>
  -H <span class="s2">"token-type: Bearer"</span> <span class="se">\</span>
  -H <span class="s2">"client: u4N6u_toFnoDR1o318uOVA"</span> <span class="se">\</span>
  -H <span class="s2">"expiry: 1466692376"</span> <span class="se">\</span>
  -H <span class="s2">"uid: abc@example.com"</span> <span class="se">\</span>
  -X DELETE
</code></pre>

<blockquote>
<p>The above command returns HTML status code 200 OK if success and json object</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"transactions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"11408bea-bb4d-460d-8614-9ca74e5419bf"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"patron_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"51b5e8fe-7724-45a7-a118-9eef4d6196cd"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"establishment_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5ca16c11-5f5e-4fda-ae6f-b485161710ed"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"challenge_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trans_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"credit"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"sales_amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-200.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"applied_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"sales_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-0.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"credit_subtotal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"200.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"remaining_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"400.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"cash_back"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.5"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trans_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"12d7967d6e"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"group_code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"tracked_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-29T18:55:17.344+08:00"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"del_transaction_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ddbd0c3c-404d-4ce1-9042-9baecb4ef585"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"deleted_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-29T18:55:18.344+08:00"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"deleted"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nt">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Credit Purchase Deletion"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>For delete correction credit transaction</p>
</blockquote>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/management/transactions/ddbd0c3c-404d-4ce1-9042-9baecb4ef585"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"access-token: token"</span> <span class="se">\</span>
  -H <span class="s2">"token-type: Bearer"</span> <span class="se">\</span>
  -H <span class="s2">"client: u4N6u_toFnoDR1o318uOVA"</span> <span class="se">\</span>
  -H <span class="s2">"expiry: 1466692376"</span> <span class="se">\</span>
  -H <span class="s2">"uid: abc@example.com"</span> <span class="se">\</span>
  -X DELETE
</code></pre>

<blockquote>
<p>The above command returns HTML status code 200 OK if success and json object</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"transactions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"6a7cdbcd-7a01-4990-8203-8a8438149dd4"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"patron_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1b93ed21-05bd-42b4-b099-2f5a6f773cee"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"establishment_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"d9f53914-b5e2-4080-a1f7-960040dcd113"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"challenge_id"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trans_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"correction"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"sales_amount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-0.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"applied_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-0.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"sales_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-0.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"credit_subtotal"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-200.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"remaining_credit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"cash_back"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.5"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"trans_code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5c90c5c7ce"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"group_code"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nt">"tracked_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-29T18:56:42.339+08:00"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"del_transaction_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2cd61542-98b1-45eb-bf76-92335257f0f2"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"deleted_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2017-03-29T18:56:43.339+08:00"</span><span class="p">,</span><span class="w">
      </span><span class="nt">"deleted"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nt">"action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Credit Correction Deletion"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>While specify delete transaction is invalid, or fake, or not belongs to current establishment</p>
</blockquote>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/management/transactions/this-is-a-fake-id"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"access-token: token"</span> <span class="se">\</span>
  -H <span class="s2">"token-type: Bearer"</span> <span class="se">\</span>
  -H <span class="s2">"client: u4N6u_toFnoDR1o318uOVA"</span> <span class="se">\</span>
  -H <span class="s2">"expiry: 1466692376"</span> <span class="se">\</span>
  -H <span class="s2">"uid: abc@example.com"</span> <span class="se">\</span>
  -X DELETE
</code></pre>

<blockquote>
<p>The above command returns HTML status code 406 and following json object</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"Transaction is invalid"</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>While specify delete transaction is created 30 days before,</p>
</blockquote>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/management/transactions/ddbd0c3c-404d-4ce1-9042-9baecb4ef585"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"access-token: token"</span> <span class="se">\</span>
  -H <span class="s2">"token-type: Bearer"</span> <span class="se">\</span>
  -H <span class="s2">"client: u4N6u_toFnoDR1o318uOVA"</span> <span class="se">\</span>
  -H <span class="s2">"expiry: 1466692376"</span> <span class="se">\</span>
  -H <span class="s2">"uid: abc@example.com"</span> <span class="se">\</span>
  -X DELETE
</code></pre>

<blockquote>
<p>The above command returns HTML status code 406 and following json object</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"Can not delete transaction created 30 days before"</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint required manager authentication, and delete transaction records.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">DELETE http://example.com/api/management/transactions/#{transaction_id}</code></p>

          <h1 id="management-settings">Management / Settings</h1>

<h2 id="get-cash-back">Get cash back</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/management/settings/cash_back"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
</code></pre>

<blockquote>
<p>if success, return http status code 200 with following json object:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"setting"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"cash_back"</span><span class="p">:</span><span class="w"> </span><span class="s2">"3.5"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>if failed, for example, unauthorized, then return http status code 401 with following json object:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"Authorized users only."</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint require <code class="prettyprint">manager authenticate</code></p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://phrenzi.com/api/management/cash_back</code></p>

<h2 id="update-cash-back">Update cash back</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/management/settings/cash_back"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -X PATCH <span class="se">\</span>
  -d <span class="s1">'{
    "password": "current_password",
    "cash_back": 4.5
    }'</span>
</code></pre>

<blockquote>
<p>if success, returns HTML status code 200 OK, with following object:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"setting"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"cash_back"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4.5"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>if unauthorize, returns HTML status code 401, with following object:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"Authorized users only."</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>if password is invalid, return HTML status code 406, with following object:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"Invalid Password"</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint require manager authenticate, and update cash_back for current establishment.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">PATCH http://phrenzi.com/api/management/cash_back</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>cash_back</td>
<td>the cash_back to update, within 0 and 100</td>
</tr>
<tr>
<td>password</td>
<td>the current password for current manager</td>
</tr>
</tbody></table>

<h2 id="update-password">Update Password</h2>
<pre class="highlight shell"><code>curl <span class="s2">"https://phrenzi.com/api/management/settings/passwords"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -X PATCH <span class="se">\</span>
  -d <span class="s1">'{
    "current_password": "current_password",
    "password": "new_password",
    "password_confirmation": "new_password"
    }'</span>
</code></pre>

<blockquote>
<p>If success, return http status code <code class="prettyprint">200</code> with following json object</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"manager"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2544a3af-cda6-4a0d-b760-17e43e1cc165"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"manager1@gmail.com"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"establishment_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Awesome Bar"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>if failed, return http status code <code class="prettyprint">422</code>, with following json object</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"current_password"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"is invalid"</span><span class="w"> </span><span class="p">],</span><span class="w">
    </span><span class="nt">"password_confirmation"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"doesn't match Password"</span><span class="w"> </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint require <code class="prettyprint">manager_token</code>, and update current password for current manager.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">PATCH http://phrenzi.com/api/management/settings/update_password</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>current_password</td>
<td>the current password for current manager</td>
</tr>
<tr>
<td>password</td>
<td>the new password for current manager</td>
</tr>
<tr>
<td>password_confirmation</td>
<td>confirmation for the new password</td>
</tr>
</tbody></table>

          <h1 id="errors">Errors</h1>

<p>The Phrenzi API uses the following error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request &ndash; Your request sucks</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized &ndash; Your API key is wrong</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden &ndash; The resource requested is hidden for administrators only</td>
</tr>
<tr>
<td>404</td>
<td>Not Found &ndash; The specified resource could not be found</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed &ndash; You tried to access a resource with an invalid method</td>
</tr>
<tr>
<td>406</td>
<td>Not Acceptable &ndash; You requested a format that isn&rsquo;t json</td>
</tr>
<tr>
<td>410</td>
<td>Gone &ndash; The resource requested has been removed from our servers</td>
</tr>
<tr>
<td>422</td>
<td>Unprocessable Entity, this happend while request params have validation errors</td>
</tr>
<tr>
<td>429</td>
<td>Too Many Requests &ndash; You&rsquo;re requesting too many resources! Slow down!</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error &ndash; We had a problem with our server. Try again later.</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable &ndash; We&rsquo;re temporarially offline for maintanance. Please try again later.</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
          </div>
      </div>
    </div>
  </body>
</html>
